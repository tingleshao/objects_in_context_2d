<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>class Object - RDoc Documentation</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>main.rb
    <li>lib/srep_toolbox.rb
    <li>lib/math_toolbox.rb
    <li>test/srep_toolbox_tester.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">BasicObject
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-checkSpokeEndAndDiskIntersection">#checkSpokeEndAndDiskIntersection</a>
    
    <li><a href="#method-i-checkSpokeIntersection">#checkSpokeIntersection</a>
    
    <li><a href="#method-i-checkSrepIntersection">#checkSrepIntersection</a>
    
    <li><a href="#method-i-computeAUsingUVK">#computeAUsingUVK</a>
    
    <li><a href="#method-i-computeBaseKappa">#computeBaseKappa</a>
    
    <li><a href="#method-i-computeBaseKappa2">#computeBaseKappa2</a>
    
    <li><a href="#method-i-ddl">#ddl</a>
    
    <li><a href="#method-i-ddl2">#ddl2</a>
    
    <li><a href="#method-i-ddl3">#ddl3</a>
    
    <li><a href="#method-i-ddl4">#ddl4</a>
    
    <li><a href="#method-i-ddl5">#ddl5</a>
    
    <li><a href="#method-i-ddl6">#ddl6</a>
    
    <li><a href="#method-i-dot">#dot</a>
    
    <li><a href="#method-i-extrapolateKappa">#extrapolateKappa</a>
    
    <li><a href="#method-i-generate2DDiscreteSrep">#generate2DDiscreteSrep</a>
    
    <li><a href="#method-i-initialConfig">#initialConfig</a>
    
    <li><a href="#method-i-interpolateKappa">#interpolateKappa</a>
    
    <li><a href="#method-i-interpolateKappa2">#interpolateKappa2</a>
    
    <li><a href="#method-i-interpolateKappa3">#interpolateKappa3</a>
    
    <li><a href="#method-i-interpolateRadius">#interpolateRadius</a>
    
    <li><a href="#method-i-interpolateSkeletalCurveGamma">#interpolateSkeletalCurveGamma</a>
    
    <li><a href="#method-i-interpolateSpokeAtPos">#interpolateSpokeAtPos</a>
    
    <li><a href="#method-i-interpolateSpokeAtPos2">#interpolateSpokeAtPos2</a>
    
    <li><a href="#method-i-linkLinkingStructurePoints">#linkLinkingStructurePoints</a>
    
    <li><a href="#method-i-refresh">#refresh</a>
    
    <li><a href="#method-i-render_field">#render_field</a>
    
    <li><a href="#method-i-spline_fit">#spline_fit</a>
    
    <li><a href="#method-i-twoDNorm2">#twoDNorm2</a>
    
    <li><a href="#method-i-twoDNormalize">#twoDNormalize</a>
    
    <li><a href="#method-i-vector_project">#vector_project</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./data/interpolated_logrkm1s_0.html">interpolated_logrkm1s_0</a>
  
    <li class="file"><a href="./data/interpolated_logrkm1s_1.html">interpolated_logrkm1s_1</a>
  
    <li class="file"><a href="./data/interpolated_logrkm1s_2.html">interpolated_logrkm1s_2</a>
  
    <li class="file"><a href="./data/interpolated_points.html">interpolated_points</a>
  
    <li class="file"><a href="./data/interpolated_points_0.html">interpolated_points_0</a>
  
    <li class="file"><a href="./data/interpolated_points_1.html">interpolated_points_1</a>
  
    <li class="file"><a href="./data/interpolated_points_2.html">interpolated_points_2</a>
  
    <li class="file"><a href="./data/interpolated_rs_0.html">interpolated_rs_0</a>
  
    <li class="file"><a href="./data/interpolated_rs_1.html">interpolated_rs_1</a>
  
    <li class="file"><a href="./data/interpolated_rs_2.html">interpolated_rs_2</a>
  
    <li class="file"><a href="./data/interpolated_rs_hi.html">interpolated_rs_hi</a>
  
    <li class="file"><a href="./data2/interpolated_logrkm1s_0.html">interpolated_logrkm1s_0</a>
  
    <li class="file"><a href="./data2/interpolated_logrkm1s_1.html">interpolated_logrkm1s_1</a>
  
    <li class="file"><a href="./data2/interpolated_logrkm1s_2.html">interpolated_logrkm1s_2</a>
  
    <li class="file"><a href="./data2/interpolated_points_0.html">interpolated_points_0</a>
  
    <li class="file"><a href="./data2/interpolated_points_1.html">interpolated_points_1</a>
  
    <li class="file"><a href="./data2/interpolated_points_2.html">interpolated_points_2</a>
  
    <li class="file"><a href="./data2/interpolated_rs_0.html">interpolated_rs_0</a>
  
    <li class="file"><a href="./data2/interpolated_rs_1.html">interpolated_rs_1</a>
  
    <li class="file"><a href="./data2/interpolated_rs_2.html">interpolated_rs_2</a>
  
    <li class="file"><a href="./view/#interpolate_control#.html">#interpolate_control#</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Atom.html">Atom</a>
  
    <li><a href="./Color.html">Color</a>
  
    <li><a href="./DrawPad.html">DrawPad</a>
  
    <li><a href="./Field.html">Field</a>
  
    <li><a href="./FileLoaderView.html">FileLoaderView</a>
  
    <li><a href="./InterpolateControl.html">InterpolateControl</a>
  
    <li><a href="./Object.html">Object</a>
  
    <li><a href="./SRep.html">SRep</a>
  
    <li><a href="./SrepInfo.html">SrepInfo</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Object</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-checkSpokeEndAndDiskIntersection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">checkSpokeEndAndDiskIntersection</span><span
            class="method-args">(x,y,srep)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="checkSpokeEndAndDiskIntersection-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 485</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">checkSpokeEndAndDiskIntersection</span>(<span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span>,<span class="ruby-identifier">srep</span>)
  <span class="ruby-comment"># this function avoids a few spokes that goes too far away</span>
  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">disk_x</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span>
    <span class="ruby-identifier">disk_y</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span>
    <span class="ruby-identifier">disk_r</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">expand_spoke_length</span>[<span class="ruby-value">0</span>] 
    <span class="ruby-identifier">disk_to_center</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(( <span class="ruby-identifier">x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">disk_x</span> ) <span class="ruby-operator">**</span> <span class="ruby-value">2</span> <span class="ruby-operator">+</span> ( <span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">disk_y</span> ) <span class="ruby-operator">**</span> <span class="ruby-value">2</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">disk_r</span> * <span class="ruby-value">0.9</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">disk_to_center</span>
       <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- checkSpokeEndAndDiskIntersection-source -->
          
        </div>

        

        
      </div><!-- checkSpokeEndAndDiskIntersection-method -->

    
      <div id="method-i-checkSpokeIntersection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">checkSpokeIntersection</span><span
            class="method-args">(x1,y1,x2,y2,x3,y3,x4,y4)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="checkSpokeIntersection-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 452</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">checkSpokeIntersection</span>(<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">y1</span>,<span class="ruby-identifier">x2</span>,<span class="ruby-identifier">y2</span>,<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">y3</span>,<span class="ruby-identifier">x4</span>,<span class="ruby-identifier">y4</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">x1</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">x2</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">x3</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">x4</span> 
    <span class="ruby-keyword">return</span> [<span class="ruby-keyword">false</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment">#compute two intervals</span>
  <span class="ruby-identifier">i1</span> = [[<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>].<span class="ruby-identifier">min</span>, [<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>].<span class="ruby-identifier">max</span>]
  <span class="ruby-identifier">i2</span> = [[<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">x4</span>].<span class="ruby-identifier">min</span>, [<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">x4</span>].<span class="ruby-identifier">max</span>]
  <span class="ruby-comment"># TEST IF THERE IS MUTUAL REGION      </span>
  <span class="ruby-keyword">if</span> ([<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>].<span class="ruby-identifier">max</span> <span class="ruby-operator">&lt;</span> [<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">x4</span>].<span class="ruby-identifier">min</span>)
    <span class="ruby-keyword">return</span> [<span class="ruby-keyword">false</span>, <span class="ruby-value">0</span> ,<span class="ruby-value">0</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># compute A and b for two lines</span>
  <span class="ruby-identifier">a1</span> = (<span class="ruby-identifier">y1</span><span class="ruby-operator">-</span><span class="ruby-identifier">y2</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">x1</span><span class="ruby-operator">-</span><span class="ruby-identifier">x2</span>)
  <span class="ruby-identifier">a2</span> = (<span class="ruby-identifier">y3</span><span class="ruby-operator">-</span><span class="ruby-identifier">y4</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">x3</span><span class="ruby-operator">-</span><span class="ruby-identifier">x4</span>)
  <span class="ruby-identifier">b1</span> = <span class="ruby-identifier">y1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">a1</span> * <span class="ruby-identifier">x1</span>
  <span class="ruby-identifier">b2</span> = <span class="ruby-identifier">y3</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">a2</span> * <span class="ruby-identifier">x3</span> 
  <span class="ruby-comment"># check if two lines are parallel </span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">a1</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">a2</span>
    <span class="ruby-keyword">return</span> [<span class="ruby-keyword">false</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># compute the intersection x</span>
  <span class="ruby-identifier">xa</span> = (<span class="ruby-identifier">b2</span><span class="ruby-operator">-</span><span class="ruby-identifier">b1</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">a1</span><span class="ruby-operator">-</span><span class="ruby-identifier">a2</span>)
  <span class="ruby-keyword">if</span> ( (<span class="ruby-identifier">xa</span><span class="ruby-operator">&lt;</span> [[<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>].<span class="ruby-identifier">min</span>, [<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">x4</span>].<span class="ruby-identifier">min</span>].<span class="ruby-identifier">max</span> ) <span class="ruby-operator">||</span> (<span class="ruby-identifier">xa</span><span class="ruby-operator">&gt;</span> [[<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>].<span class="ruby-identifier">max</span>, [<span class="ruby-identifier">x3</span>,<span class="ruby-identifier">x4</span>].<span class="ruby-identifier">max</span>].<span class="ruby-identifier">min</span>) )
    <span class="ruby-keyword">return</span> [<span class="ruby-keyword">false</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>]
  <span class="ruby-keyword">else</span> 
    <span class="ruby-identifier">ya</span> = <span class="ruby-identifier">a1</span> * <span class="ruby-identifier">xa</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">b1</span>
   <span class="ruby-keyword">if</span> <span class="ruby-identifier">ya</span>.<span class="ruby-identifier">nan?</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;stuff: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x1</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y1</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x2</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y2</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x3</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span>  <span class="ruby-operator">+</span> <span class="ruby-identifier">y3</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x4</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y4</span>.<span class="ruby-identifier">to_s</span>
   <span class="ruby-keyword">end</span>  
  <span class="ruby-keyword">return</span> [<span class="ruby-keyword">true</span>, <span class="ruby-identifier">xa</span>, <span class="ruby-identifier">ya</span>]
  <span class="ruby-keyword">end</span>    
<span class="ruby-keyword">end</span></pre>
          </div><!-- checkSpokeIntersection-source -->
          
        </div>

        

        
      </div><!-- checkSpokeIntersection-method -->

    
      <div id="method-i-checkSrepIntersection" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">checkSrepIntersection</span><span
            class="method-args">(srep1, srep2, shift1, shift2)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="checkSrepIntersection-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 134</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">checkSrepIntersection</span>(<span class="ruby-identifier">srep1</span>, <span class="ruby-identifier">srep2</span>, <span class="ruby-identifier">shift1</span>, <span class="ruby-identifier">shift2</span>)
  <span class="ruby-comment"># this function checks the intersection between s-reps before spoke interpolation</span>
  <span class="ruby-comment"># returns a list indicates that for each atom in srep1, what is the correspoinding neighbor srep color </span>
  <span class="ruby-identifier">correLst</span> = []
  <span class="ruby-identifier">srep1</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom1</span>, <span class="ruby-identifier">j</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">correLst</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">0</span>, <span class="ruby-keyword">nil</span>]
    <span class="ruby-identifier">atom1posX</span> = <span class="ruby-identifier">atom1</span>.<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift1</span>
    <span class="ruby-identifier">atom1posY</span> = <span class="ruby-identifier">atom1</span>.<span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift1</span>
    <span class="ruby-identifier">srep2_0PosX</span> = <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift2</span>
    <span class="ruby-identifier">srep2_0PosY</span> = <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift2</span>
    <span class="ruby-identifier">minDistSoFar</span> = <span class="ruby-identifier">getDistance</span>(<span class="ruby-identifier">atom1posX</span>, <span class="ruby-identifier">atom1posY</span>, <span class="ruby-identifier">srep2_0PosX</span>, <span class="ruby-identifier">srep2_0PosY</span>)
    <span class="ruby-identifier">distToSrep2_0</span> = <span class="ruby-identifier">atom1</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">minDistSoFar</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">distToSrep2_0</span>
      <span class="ruby-identifier">correLst</span>[<span class="ruby-identifier">j</span>] = [<span class="ruby-value">1</span>,<span class="ruby-value">0</span>]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom2</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">atom2posX</span> = <span class="ruby-identifier">atom2</span>.<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift2</span>
      <span class="ruby-identifier">atom2posY</span> = <span class="ruby-identifier">atom2</span>.<span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">shift2</span>
      <span class="ruby-comment"># asssume all three r's for one atom are equivalent to each other (partial blum?  case)</span>
      <span class="ruby-identifier">r1PlusR2</span> = <span class="ruby-identifier">atom1</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">atom2</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">dist</span> =  <span class="ruby-identifier">getDistance</span>(<span class="ruby-identifier">atom1posX</span>, <span class="ruby-identifier">atom1posY</span>, <span class="ruby-identifier">atom2posX</span>, <span class="ruby-identifier">atom2posY</span>) 
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">dist</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">r1PlusR2</span> 
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">dist</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">minDistSoFar</span>
          <span class="ruby-identifier">correLst</span>[<span class="ruby-identifier">j</span>] = [<span class="ruby-value">1</span>, <span class="ruby-identifier">i</span>]
          <span class="ruby-identifier">minDistSoFar</span> = <span class="ruby-identifier">dist</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">correLst</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- checkSrepIntersection-source -->
          
        </div>

        

        
      </div><!-- checkSrepIntersection-method -->

    
      <div id="method-i-computeAUsingUVK" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">computeAUsingUVK</span><span
            class="method-args">(ut,vt,kt)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="computeAUsingUVK-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 442</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">computeAUsingUVK</span>(<span class="ruby-identifier">ut</span>,<span class="ruby-identifier">vt</span>,<span class="ruby-identifier">kt</span>)
<span class="ruby-comment"># make sure kt and vt are all nomalized</span>

  <span class="ruby-identifier">ut</span> = <span class="ruby-identifier">twoDNormalize</span>(<span class="ruby-identifier">ut</span>)

  <span class="ruby-identifier">a</span> = <span class="ruby-identifier">kt</span> * <span class="ruby-identifier">dot</span>(<span class="ruby-identifier">ut</span>,<span class="ruby-identifier">vt</span>)   
  <span class="ruby-identifier">print</span> <span class="ruby-string">&quot;a: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">a</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot;\n&quot;</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">a</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- computeAUsingUVK-source -->
          
        </div>

        

        
      </div><!-- computeAUsingUVK-method -->

    
      <div id="method-i-computeBaseKappa" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">computeBaseKappa</span><span
            class="method-args">(xt,yt, indices, h, rt)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="computeBaseKappa-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">computeBaseKappa</span>(<span class="ruby-identifier">xt</span>,<span class="ruby-identifier">yt</span>, <span class="ruby-identifier">indices</span>, <span class="ruby-identifier">h</span>, <span class="ruby-identifier">rt</span>)
  <span class="ruby-comment"># this function computes kappas at base points using the curvature formula</span>
  <span class="ruby-comment"># also checks whether rk at these base points are smaller than 1</span>
  <span class="ruby-comment"># k = (x'y''-y'x'') / (x'^2+y'^2)^(3/2)</span>
  <span class="ruby-comment"># compute numerical derivatives </span>
  <span class="ruby-comment"># for end points the way to compute derivatives are different</span>
  <span class="ruby-comment"># the index should not contain the first and the last index</span>

  <span class="ruby-comment"># need to change this so that kappa is computed as swing of spokes </span>
  <span class="ruby-identifier">dx</span> = []
  <span class="ruby-identifier">dy</span> = []
  <span class="ruby-identifier">ddx</span> = []
  <span class="ruby-identifier">ddy</span> = []
  <span class="ruby-identifier">dx0</span> = (<span class="ruby-identifier">xt</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dx1</span> = (<span class="ruby-identifier">xt</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-value">1</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dxe</span> = (<span class="ruby-identifier">xt</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-value">-2</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dxem1</span> = (<span class="ruby-identifier">xt</span>[<span class="ruby-value">-2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-value">-3</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">ddx0</span> = (<span class="ruby-identifier">dx1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dx0</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">ddxe</span> = (<span class="ruby-identifier">dxe</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dxem1</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dy0</span> = (<span class="ruby-identifier">yt</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dy1</span> = (<span class="ruby-identifier">yt</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-value">1</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dye</span> = (<span class="ruby-identifier">yt</span>[<span class="ruby-value">-1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-value">-2</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dyem1</span> = (<span class="ruby-identifier">yt</span>[<span class="ruby-value">-2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-value">-3</span>]) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">ddy0</span> = (<span class="ruby-identifier">dy1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dy0</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">ddye</span> = (<span class="ruby-identifier">dye</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dyem1</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">h</span>
  <span class="ruby-identifier">dx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dx0</span>
  <span class="ruby-identifier">dy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dy0</span>
  <span class="ruby-identifier">ddx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddx0</span>
  <span class="ruby-identifier">ddy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddy0</span>
 
  <span class="ruby-identifier">rs</span> = []
  <span class="ruby-identifier">rs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rt</span>[<span class="ruby-value">0</span>]
 
  <span class="ruby-identifier">indices</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> (<span class="ruby-identifier">xt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)   
      <span class="ruby-identifier">dxi</span> = ( <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>] ) <span class="ruby-operator">/</span> (<span class="ruby-value">2</span> * <span class="ruby-identifier">h</span>)
      <span class="ruby-identifier">dyi</span> = ( <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>] ) <span class="ruby-operator">/</span> (<span class="ruby-value">2</span> * <span class="ruby-identifier">h</span>)
      <span class="ruby-identifier">ddxi</span> = (<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> (<span class="ruby-value">2</span> * <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span>]) <span class="ruby-operator">+</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]) <span class="ruby-operator">/</span> (<span class="ruby-identifier">h</span><span class="ruby-operator">**</span><span class="ruby-value">2.0</span>)
      <span class="ruby-identifier">ddyi</span> = (<span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> (<span class="ruby-value">2</span> * <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span>]) <span class="ruby-operator">+</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]) <span class="ruby-operator">/</span> (<span class="ruby-identifier">h</span><span class="ruby-operator">**</span><span class="ruby-value">2.0</span>) 
      <span class="ruby-identifier">dx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dxi</span> 
      <span class="ruby-identifier">dy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dyi</span> 
      <span class="ruby-identifier">ddx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddxi</span>
      <span class="ruby-identifier">ddy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddyi</span>
 
      <span class="ruby-identifier">rs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rt</span>[<span class="ruby-identifier">i</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">rt</span>[<span class="ruby-value">-1</span>]
  <span class="ruby-identifier">dx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dxe</span>
  <span class="ruby-identifier">dy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">dye</span>
  <span class="ruby-identifier">ddx</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddxe</span>
  <span class="ruby-identifier">ddy</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ddye</span>
  <span class="ruby-identifier">kappa</span> = []
  <span class="ruby-identifier">kr</span> = []
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;***********************************&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;dx: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dx</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">dx</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dxi</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ki</span> = (<span class="ruby-identifier">dx</span>[<span class="ruby-identifier">i</span>] * <span class="ruby-identifier">ddy</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">dy</span>[<span class="ruby-identifier">i</span>] * <span class="ruby-identifier">ddx</span>[<span class="ruby-identifier">i</span>]) <span class="ruby-operator">/</span> ((<span class="ruby-identifier">dx</span>[<span class="ruby-identifier">i</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>)<span class="ruby-operator">+</span>(<span class="ruby-identifier">dy</span>[<span class="ruby-identifier">i</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>))<span class="ruby-operator">**</span>(<span class="ruby-value">3.0</span><span class="ruby-operator">/</span><span class="ruby-value">2.0</span>) 
    <span class="ruby-identifier">kappa</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ki</span>
    <span class="ruby-comment">#compute k * r </span>
    <span class="ruby-identifier">kri</span> = <span class="ruby-identifier">ki</span> * <span class="ruby-identifier">rs</span>[<span class="ruby-identifier">i</span>]
    <span class="ruby-identifier">kr</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">kri</span>
  <span class="ruby-keyword">end</span>
 
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">kappa</span>, <span class="ruby-identifier">kr</span> 
<span class="ruby-keyword">end</span></pre>
          </div><!-- computeBaseKappa-source -->
          
        </div>

        

        
      </div><!-- computeBaseKappa-method -->

    
      <div id="method-i-computeBaseKappa2" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">computeBaseKappa2</span><span
            class="method-args">(ub,vb,base_indices)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>%%%%%%%%%%%%%%%%%%%%% need to work on this %%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%</p>
          

          
          <div class="method-source-code" id="computeBaseKappa2-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 284</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">computeBaseKappa2</span>(<span class="ruby-identifier">ub</span>,<span class="ruby-identifier">vb</span>,<span class="ruby-identifier">base_indices</span>)
  <span class="ruby-comment"># this is the correct version of base kappa computation</span>
  <span class="ruby-comment"># steps:</span>
  <span class="ruby-comment">#      1. use ub, compute swing of u: du on base points</span>
  <span class="ruby-comment">#      2. use vb, compute du proj on v</span>
  <span class="ruby-comment">#      3. divided by length of v get the kappa k on base points </span>
  <span class="ruby-identifier">number_of_base_points</span> = <span class="ruby-identifier">ub</span>.<span class="ruby-identifier">size</span>
  <span class="ruby-identifier">du</span> = []
  (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">ub</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">du</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">ub</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">ub</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>][<span class="ruby-value">0</span>], <span class="ruby-identifier">ub</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">ub</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>][<span class="ruby-value">1</span>]]
  <span class="ruby-keyword">end</span>
   <span class="ruby-comment"># this Du is swing of spokes between two base points. it should be divided by the step size</span>
  <span class="ruby-comment">#   to get the estimatd swing of spokes for base points for one step size.</span>
  <span class="ruby-comment"># compute distance between base indices (number of step sizes) </span>
  <span class="ruby-identifier">indices_distance</span> = []
  (<span class="ruby-identifier">base_indices</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>).<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">|</span>
    <span class="ruby-identifier">indices_distance</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">base_indices</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">base_indices</span>[<span class="ruby-identifier">i</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># compute the average between adjacent du's</span>
  <span class="ruby-identifier">avgDu</span> = []
  (<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-identifier">ub</span>.<span class="ruby-identifier">size</span><span class="ruby-operator">-</span><span class="ruby-value">2</span>).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span>, <span class="ruby-identifier">ind</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">avgDu</span> <span class="ruby-operator">&lt;&lt;</span> [(<span class="ruby-identifier">du</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">du</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>][<span class="ruby-value">0</span>]) <span class="ruby-operator">/</span> (<span class="ruby-value">2</span>*<span class="ruby-identifier">indices_distance</span>[<span class="ruby-identifier">ind</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]), (<span class="ruby-identifier">du</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">1</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">du</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>][<span class="ruby-value">1</span>]) <span class="ruby-operator">/</span> (<span class="ruby-value">2</span>*<span class="ruby-identifier">indices_distance</span>[<span class="ruby-identifier">ind</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>])]
  <span class="ruby-keyword">end</span> 
 

  <span class="ruby-comment"># now we have du</span>
  <span class="ruby-identifier">k</span> = []
  <span class="ruby-comment"># first k and last k are from du</span>
 <span class="ruby-comment"># k &lt;&lt; vector_project(du[0], vb[0])[1]/indices_distance[0]</span>
  <span class="ruby-identifier">avgDu</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">one_du</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span> 
    <span class="ruby-identifier">k</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">vector_project</span>(<span class="ruby-identifier">one_du</span>, <span class="ruby-identifier">vb</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>])[<span class="ruby-value">1</span>]
  <span class="ruby-keyword">end</span> 
<span class="ruby-comment">#  k_0 = k[0] - (k[1] - k[0])</span>
 <span class="ruby-comment"># k_last = k[-2] - ( k [-1] - k[-2])</span>
 
 <span class="ruby-comment"># k &lt;&lt; vector_project(du[-1], vb[-1])[1]/indices_distance[-1]</span>
  <span class="ruby-comment"># now we have k</span>
  <span class="ruby-comment">### </span>
  <span class="ruby-comment">#  may check the whether k's length is the same as number of base points </span>
  <span class="ruby-comment">###</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;are they the same? &quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">k</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">ub</span>.<span class="ruby-identifier">size</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-comment"># just need that scalar </span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">k</span> 
<span class="ruby-keyword">end</span></pre>
          </div><!-- computeBaseKappa2-source -->
          
        </div>

        

        
      </div><!-- computeBaseKappa2-method -->

    
      <div id="method-i-ddl" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 4</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl</span>
<span class="ruby-identifier">srep1</span>= <span class="ruby-identifier">generateStraight2DDiscreteSrep</span>(<span class="ruby-value">20</span>,<span class="ruby-value">15</span>,<span class="ruby-value">64</span>,<span class="ruby-value">64</span>,<span class="ruby-value">128</span>,<span class="ruby-value">3</span>);
<span class="ruby-comment">#~ srep2 = generate2DDiscreteSrep(20,15,32,32,128);</span>
<span class="ruby-comment">#~ $corrLes = checkSrepIntersection(srep1, srep2, 0,0);</span>
<span class="ruby-keyword">return</span> <span class="ruby-identifier">srep1</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl-source -->
          
        </div>

        

        
      </div><!-- ddl-method -->

    
      <div id="method-i-ddl2" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl2</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl2-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 11</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl2</span>
  <span class="ruby-identifier">srep1</span> = <span class="ruby-identifier">generateStraight2DDiscreteSrepC</span>();
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">srep1</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl2-source -->
          
        </div>

        

        
      </div><!-- ddl2-method -->

    
      <div id="method-i-ddl3" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl3</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl3-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 16</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl3</span>
  <span class="ruby-identifier">points</span> = [[<span class="ruby-value">10</span>,<span class="ruby-value">20</span>],[<span class="ruby-value">20</span>,<span class="ruby-value">15</span>],[<span class="ruby-value">30</span>,<span class="ruby-value">10</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">12</span>],[<span class="ruby-value">50</span>,<span class="ruby-value">16</span>]]
  <span class="ruby-identifier">l</span> = [[<span class="ruby-value">7</span>,<span class="ruby-value">7</span>,<span class="ruby-value">7</span>],[<span class="ruby-value">7</span>,<span class="ruby-value">7</span>],[<span class="ruby-value">7</span>,<span class="ruby-value">7</span>],[<span class="ruby-value">8</span>,<span class="ruby-value">8</span>],[<span class="ruby-value">7</span>,<span class="ruby-value">7</span>,<span class="ruby-value">7</span>]]
  <span class="ruby-identifier">u</span> = [[[<span class="ruby-value">-1</span>,<span class="ruby-value">3</span>],[<span class="ruby-value">-1</span>,<span class="ruby-value">-4</span>],[<span class="ruby-value">-3</span>,<span class="ruby-value">-1</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">-1</span>,<span class="ruby-value">-5</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">-1</span>,<span class="ruby-value">-6</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">9</span>],[<span class="ruby-value">1</span>,<span class="ruby-value">-8</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">2</span>],[<span class="ruby-value">1</span>,<span class="ruby-value">-5</span>],[<span class="ruby-value">3</span>,<span class="ruby-value">2</span>]]]
  <span class="ruby-identifier">srep</span> = <span class="ruby-identifier">generate2DDiscreteSrep</span>(<span class="ruby-identifier">points</span>,<span class="ruby-identifier">l</span>,<span class="ruby-identifier">u</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">'ddl'</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-identifier">srep</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl3-source -->
          
        </div>

        

        
      </div><!-- ddl3-method -->

    
      <div id="method-i-ddl4" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl4</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl4-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 25</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl4</span>
  <span class="ruby-identifier">points</span> = [[<span class="ruby-value">50</span>,<span class="ruby-value">100</span>],[<span class="ruby-value">100</span>,<span class="ruby-value">75</span>],[<span class="ruby-value">150</span>,<span class="ruby-value">50</span>],[<span class="ruby-value">200</span>,<span class="ruby-value">60</span>],[<span class="ruby-value">250</span>,<span class="ruby-value">80</span>]]
  <span class="ruby-identifier">x</span> = <span class="ruby-identifier">points</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>[<span class="ruby-value">0</span>]}

  <span class="ruby-identifier">y</span> = <span class="ruby-identifier">points</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>[<span class="ruby-value">1</span>]}
<span class="ruby-comment">#  puts &quot;y: &quot; + y.to_s</span>
  <span class="ruby-identifier">interpolateSkeletalCurveGamma</span>(<span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span>,<span class="ruby-value">0.01</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl4-source -->
          
        </div>

        

        
      </div><!-- ddl4-method -->

    
      <div id="method-i-ddl5" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl5</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl5-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 34</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl5</span>
  <span class="ruby-comment"># test compute kappa at base points </span>
  <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'interpolated_points_0'</span>, <span class="ruby-string">'r'</span>)
  <span class="ruby-identifier">xs</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>)
  <span class="ruby-identifier">ys</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>)  
  <span class="ruby-identifier">xt</span> = []
  <span class="ruby-identifier">xs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">xt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">yt</span> = []
  <span class="ruby-identifier">ys</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">y</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">yt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">y</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">h</span> = <span class="ruby-value">0.01</span>
  <span class="ruby-keyword">while</span> <span class="ruby-identifier">l</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">gets</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;l: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">l</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span>
  <span class="ruby-identifier">ff</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">'interpolated_rs_0'</span>, <span class="ruby-string">'r'</span>)
  <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">gets</span>
  <span class="ruby-identifier">rs</span> = <span class="ruby-identifier">ff</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;rs: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rs</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">rt</span> = []
  <span class="ruby-identifier">rs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">rt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_f</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">indices</span> = []
  <span class="ruby-identifier">points</span> = [[<span class="ruby-value">50</span>,<span class="ruby-value">100</span>],[<span class="ruby-value">100</span>,<span class="ruby-value">75</span>],[<span class="ruby-value">150</span>,<span class="ruby-value">50</span>],[<span class="ruby-value">200</span>,<span class="ruby-value">60</span>],[<span class="ruby-value">250</span>,<span class="ruby-value">80</span>]]
  <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">points</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">points</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
      <span class="ruby-identifier">v</span> = <span class="ruby-identifier">xt</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">x</span><span class="ruby-operator">-</span><span class="ruby-identifier">p</span>[<span class="ruby-value">0</span>]).<span class="ruby-identifier">abs</span> }.<span class="ruby-identifier">each_with_index</span>.<span class="ruby-identifier">min</span>
      <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">v</span>[<span class="ruby-value">1</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xt</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>

  <span class="ruby-identifier">kappa</span>,<span class="ruby-identifier">kt</span> = <span class="ruby-identifier">computeBaseKappa</span>(<span class="ruby-identifier">xt</span>,<span class="ruby-identifier">yt</span>, <span class="ruby-identifier">indices</span>, <span class="ruby-identifier">h</span>, <span class="ruby-identifier">rt</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">kappa</span>,<span class="ruby-identifier">kt</span>,<span class="ruby-identifier">rt</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl5-source -->
          
        </div>

        

        
      </div><!-- ddl5-method -->

    
      <div id="method-i-ddl6" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ddl6</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="ddl6-source">
            <pre><span class="ruby-comment"># File test/srep_toolbox_tester.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ddl6</span>
<span class="ruby-comment"># test what the file exactl gets</span>
<span class="ruby-identifier">foo</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">'interpolated_points_0'</span>, <span class="ruby-string">'r'</span>)
<span class="ruby-identifier">x</span> = <span class="ruby-identifier">foo</span>.<span class="ruby-identifier">gets</span>
<span class="ruby-identifier">y</span> = <span class="ruby-identifier">foo</span>.<span class="ruby-identifier">gets</span>
<span class="ruby-identifier">foo</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">'interpolated_rs_0'</span>, <span class="ruby-string">'r'</span>)
<span class="ruby-identifier">r</span> = <span class="ruby-identifier">foo</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">bar</span><span class="ruby-operator">|</span> <span class="ruby-identifier">bar</span>.<span class="ruby-identifier">to_f</span>}
<span class="ruby-identifier">foo</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-string">'interpolated_logrkm1s_0'</span>, <span class="ruby-string">'r'</span>)
<span class="ruby-identifier">logrkm1</span> = <span class="ruby-identifier">foo</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&quot; &quot;</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">bar</span><span class="ruby-operator">|</span> <span class="ruby-identifier">bar</span>.<span class="ruby-identifier">to_f</span>    }
<span class="ruby-identifier">puts</span> <span class="ruby-string">'x: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x</span>
<span class="ruby-identifier">puts</span> <span class="ruby-string">'y: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y</span>
<span class="ruby-identifier">puts</span> <span class="ruby-string">'r: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">length</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-identifier">puts</span> <span class="ruby-string">'logrkm1: '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">length</span>.<span class="ruby-identifier">to_s</span>

<span class="ruby-keyword">end</span></pre>
          </div><!-- ddl6-source -->
          
        </div>

        

        
      </div><!-- ddl6-method -->

    
      <div id="method-i-dot" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">dot</span><span
            class="method-args">(a,b)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="dot-source">
            <pre><span class="ruby-comment"># File lib/math_toolbox.rb, line 24</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">dot</span>(<span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span>)
  <span class="ruby-comment"># compute dot product of a and b</span>
  <span class="ruby-comment"># assume a and b are vectors in 2D</span>
  <span class="ruby-identifier">p</span> = <span class="ruby-identifier">a</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">b</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">a</span>[<span class="ruby-value">1</span>] * <span class="ruby-identifier">b</span>[<span class="ruby-value">1</span>]
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">p</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- dot-source -->
          
        </div>

        

        
      </div><!-- dot-method -->

    
      <div id="method-i-extrapolateKappa" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">extrapolateKappa</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="extrapolateKappa-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 398</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">extrapolateKappa</span>()
 <span class="ruby-comment"># this function extrapolates kappa ...</span>

<span class="ruby-keyword">end</span></pre>
          </div><!-- extrapolateKappa-source -->
          
        </div>

        

        
      </div><!-- extrapolateKappa-method -->

    
      <div id="method-i-generate2DDiscreteSrep" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">generate2DDiscreteSrep</span><span
            class="method-args">(atoms, spoke_length, spoke_direction, step_size, srep_index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="generate2DDiscreteSrep-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 20</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">generate2DDiscreteSrep</span>(<span class="ruby-identifier">atoms</span>, <span class="ruby-identifier">spoke_length</span>, <span class="ruby-identifier">spoke_direction</span>, <span class="ruby-identifier">step_size</span>, <span class="ruby-identifier">srep_index</span>)
  <span class="ruby-comment"># This function returns an srep which has parameters specified in the arguments lists</span>
  <span class="ruby-identifier">srep</span> = <span class="ruby-constant">SRep</span>.<span class="ruby-identifier">new</span>()
  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">index</span> = <span class="ruby-identifier">srep_index</span>       
  <span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">spoke_length</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
        <span class="ruby-identifier">type</span> = <span class="ruby-string">'end'</span>
    <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">type</span> = <span class="ruby-string">'inner'</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># normalize the u vector</span>
    <span class="ruby-identifier">usi</span> = <span class="ruby-identifier">spoke_direction</span>[<span class="ruby-identifier">i</span>]
    <span class="ruby-identifier">usi</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ui</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">usi</span>[<span class="ruby-identifier">index</span>] = [<span class="ruby-constant">Float</span>(<span class="ruby-identifier">ui</span>[<span class="ruby-value">0</span>]),<span class="ruby-constant">Float</span>(<span class="ruby-identifier">ui</span>[<span class="ruby-value">1</span>])]
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">usi</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ui</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span> = <span class="ruby-identifier">ui</span>[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">y</span> = <span class="ruby-identifier">ui</span>[<span class="ruby-value">1</span>]
      <span class="ruby-identifier">ui</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">foo</span>, <span class="ruby-identifier">index2</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">ui</span>[<span class="ruby-identifier">index2</span>] = <span class="ruby-identifier">foo</span> <span class="ruby-operator">/</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">x</span><span class="ruby-operator">**</span><span class="ruby-value">2</span><span class="ruby-operator">+</span><span class="ruby-identifier">y</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span> 
    <span class="ruby-comment"># make sure the spoke length vector is in type Float</span>
    <span class="ruby-identifier">li</span> = <span class="ruby-identifier">spoke_length</span>[<span class="ruby-identifier">i</span>]
    <span class="ruby-identifier">li</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">l</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">li</span>[<span class="ruby-identifier">index</span>] = <span class="ruby-constant">Float</span>(<span class="ruby-identifier">l</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># make sure the positions x-y is in type Float</span>
    <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">foo</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">atom</span>[<span class="ruby-identifier">index</span>] = <span class="ruby-constant">Float</span>(<span class="ruby-identifier">foo</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">atom_obj</span> = <span class="ruby-constant">Atom</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">li</span>, <span class="ruby-identifier">usi</span>, <span class="ruby-identifier">type</span>, <span class="ruby-identifier">atom</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">atom</span>[<span class="ruby-value">1</span>], <span class="ruby-constant">Color</span>.<span class="ruby-identifier">red</span>)
    <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">atom_obj</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">color</span> = <span class="ruby-constant">Color</span>.<span class="ruby-identifier">default</span>

  <span class="ruby-comment"># compute the interpolated curve </span>
  <span class="ruby-identifier">xt</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">atom</span><span class="ruby-operator">|</span> <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span> }
  <span class="ruby-identifier">yt</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">atom</span><span class="ruby-operator">|</span> <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span> }
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;srep: index in toolbox: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">curve</span> = <span class="ruby-identifier">interpolateSkeletalCurveGamma</span>(<span class="ruby-identifier">xt</span>, <span class="ruby-identifier">yt</span>, <span class="ruby-identifier">step_size</span>, <span class="ruby-identifier">srep_index</span>)
  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">skeletal_curve</span> = <span class="ruby-identifier">curve</span>

  <span class="ruby-comment"># compute indices </span>
  <span class="ruby-identifier">indices</span> = []
  <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
      <span class="ruby-identifier">diff</span> = <span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> (<span class="ruby-identifier">x</span><span class="ruby-operator">-</span><span class="ruby-identifier">atom</span>[<span class="ruby-value">0</span>]).<span class="ruby-identifier">abs</span> }
      <span class="ruby-identifier">v</span> = <span class="ruby-identifier">diff</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">diff</span>.<span class="ruby-identifier">min</span>)
      <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">v</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">indices</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">base_index</span> = <span class="ruby-identifier">indices</span>   
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;indices: &quot;</span><span class="ruby-operator">+</span>  <span class="ruby-identifier">indices</span>.<span class="ruby-identifier">to_s</span>

  <span class="ruby-comment"># use the curve and upper spokes to get the value of lower spokes and end spokes </span>
  <span class="ruby-comment"># calculate v at base points</span>
  <span class="ruby-identifier">v</span>= []
  <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;&lt;</span> [ <span class="ruby-value">-1</span>*(<span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">0</span>]]), <span class="ruby-value">1</span>*(<span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">0</span>]])]

  <span class="ruby-identifier">indices</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">ind</span>, <span class="ruby-identifier">i</span> <span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">indices</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">ind</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">ind</span>], <span class="ruby-value">-1</span>*(<span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">ind</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">ind</span>])]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  
  <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;&lt;</span> [ <span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">-1</span>]] <span class="ruby-operator">-</span> <span class="ruby-identifier">curve</span>[<span class="ruby-value">0</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">-1</span>]<span class="ruby-operator">-</span><span class="ruby-value">1</span>], <span class="ruby-value">-1</span>* (<span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">-1</span>]]<span class="ruby-operator">-</span> <span class="ruby-identifier">curve</span>[<span class="ruby-value">1</span>][<span class="ruby-identifier">indices</span>[<span class="ruby-value">-1</span>]<span class="ruby-operator">-</span><span class="ruby-value">1</span>]) ] 
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;v: &quot;</span><span class="ruby-operator">+</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">refine</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">refine</span>
  <span class="ruby-comment"># make sure the upper and lower spokes have the same angle</span>
  <span class="ruby-comment"># get the upper spokes directions </span>
    <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span> 
      <span class="ruby-identifier">u1</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]  
      <span class="ruby-identifier">size_norm_v</span>=  <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">v</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">1</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span>)
      <span class="ruby-identifier">norm_v</span> = [<span class="ruby-identifier">v</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">size_norm_v</span> ,  <span class="ruby-identifier">v</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">1</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">size_norm_v</span> ]
      <span class="ruby-identifier">u1_proj_on_v</span> = <span class="ruby-identifier">norm_v</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>* (<span class="ruby-identifier">u1</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">norm_v</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">u1</span>[<span class="ruby-value">1</span>] * <span class="ruby-identifier">norm_v</span>[<span class="ruby-value">1</span>])} 
      <span class="ruby-identifier">size_proj</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span> )
      <span class="ruby-identifier">norm_proj</span> = [<span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">size_proj</span>, <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">size_proj</span>]
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;norm_v: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">norm_v</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;norm_proj: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">norm_proj</span>.<span class="ruby-identifier">to_s</span>

      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;u1_proj_on_v: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">u1_proj_on_v</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">u1_prep_to_v</span> = [<span class="ruby-identifier">u1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">u1</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">1</span>]]
      <span class="ruby-identifier">u0</span> = [<span class="ruby-value">1</span> * <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">u1_prep_to_v</span>[<span class="ruby-value">0</span>], <span class="ruby-value">1</span>  *  <span class="ruby-identifier">u1_proj_on_v</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">u1_prep_to_v</span>[<span class="ruby-value">1</span>]]
      <span class="ruby-comment"># normalize u0</span>
      <span class="ruby-identifier">u0_size</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">u0</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">**</span> <span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">u0</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span>)  
      <span class="ruby-identifier">u0</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">u0</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">u0_size</span>
      <span class="ruby-identifier">u0</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">u0</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">u0_size</span>
      <span class="ruby-comment">#check whether perpendicular</span>
      <span class="ruby-identifier">diff</span> = [<span class="ruby-identifier">u0</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">u1</span>[<span class="ruby-value">0</span>],<span class="ruby-identifier">u0</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">u1</span>[<span class="ruby-value">1</span>]]
      <span class="ruby-identifier">prod</span> = <span class="ruby-identifier">diff</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">norm_v</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">diff</span>[<span class="ruby-value">1</span>]*<span class="ruby-identifier">norm_v</span>[<span class="ruby-value">1</span>]
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;prod: &quot;</span><span class="ruby-operator">+</span> <span class="ruby-identifier">prod</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">u0</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># for the end spokes, set their direction to the v </span>
    <span class="ruby-identifier">a0u2</span> = [<span class="ruby-identifier">v</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>], <span class="ruby-identifier">v</span>[<span class="ruby-value">0</span>][<span class="ruby-value">1</span>]]
    <span class="ruby-identifier">a0u2_size</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">a0u2</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">**</span> <span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">a0u2</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span>)
    <span class="ruby-identifier">a0u2</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">a0u2</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">a0u2_size</span>
    <span class="ruby-identifier">a0u2</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">a0u2</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">a0u2_size</span>
    <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">2</span>] = <span class="ruby-identifier">a0u2</span>

    <span class="ruby-identifier">aendu2</span> = [<span class="ruby-identifier">v</span>[<span class="ruby-value">-1</span>][<span class="ruby-value">0</span>], <span class="ruby-identifier">v</span>[<span class="ruby-value">-1</span>][<span class="ruby-value">1</span>]]
    <span class="ruby-identifier">aendu2_size</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">aendu2</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">**</span> <span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">aendu2</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">**</span><span class="ruby-value">2</span>)
    <span class="ruby-identifier">aendu2</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">aendu2</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">aendu2_size</span>
    <span class="ruby-identifier">aendu2</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">aendu2</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">/</span> <span class="ruby-identifier">aendu2_size</span>
    <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">-1</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">2</span>] = <span class="ruby-identifier">aendu2</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">srep</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- generate2DDiscreteSrep-source -->
          
        </div>

        

        
      </div><!-- generate2DDiscreteSrep-method -->

    
      <div id="method-i-initialConfig" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">initialConfig</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>initialization</p>
          

          
          <div class="method-source-code" id="initialConfig-source">
            <pre><span class="ruby-comment"># File main.rb, line 740</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialConfig</span>
  <span class="ruby-identifier">$step_go_so_far</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@shifts</span> = [<span class="ruby-value">300</span>,<span class="ruby-value">300</span>,<span class="ruby-value">300</span>]
  <span class="ruby-identifier">$current_base_index</span> = <span class="ruby-value">0</span>       
  <span class="ruby-identifier">$info</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-identifier">$dilateCount</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">$linkingPts</span> = []
  <span class="ruby-identifier">$show_linking_structure</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">$flip</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">points0</span> = [[<span class="ruby-value">110</span>,<span class="ruby-value">100</span>],[<span class="ruby-value">160</span>,<span class="ruby-value">75</span>],[<span class="ruby-value">210</span>,<span class="ruby-value">50</span>],[<span class="ruby-value">260</span>,<span class="ruby-value">60</span>],[<span class="ruby-value">310</span>,<span class="ruby-value">80</span>]]
  <span class="ruby-identifier">l0</span> = [[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>,<span class="ruby-value">35</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">30</span>,<span class="ruby-value">30</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>,<span class="ruby-value">35</span>]]
  <span class="ruby-identifier">u0</span> = [[[<span class="ruby-value">-1</span>,<span class="ruby-value">3</span>],[<span class="ruby-value">-0.1</span>,<span class="ruby-value">-4</span>],[<span class="ruby-value">-9</span>,<span class="ruby-value">1</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">1.1</span>,<span class="ruby-value">-3</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">0.2</span>,<span class="ruby-value">-6</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">9</span>],[<span class="ruby-value">0.05</span>,<span class="ruby-value">-8</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">2</span>],[<span class="ruby-value">1</span>,<span class="ruby-value">-5</span>],[<span class="ruby-value">6</span>,<span class="ruby-value">1</span>]]]
  <span class="ruby-identifier">srep0</span> = <span class="ruby-identifier">generate2DDiscreteSrep</span>(<span class="ruby-identifier">points0</span>,<span class="ruby-identifier">l0</span>,<span class="ruby-identifier">u0</span>,<span class="ruby-value">0.01</span>,<span class="ruby-value">0</span>)
  <span class="ruby-identifier">srep0</span>.<span class="ruby-identifier">orientation</span> = [<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]
  <span class="ruby-identifier">$sreps</span> = [<span class="ruby-identifier">srep0</span>]

  <span class="ruby-identifier">points1</span> = [[<span class="ruby-value">200</span>,<span class="ruby-value">190</span>],[<span class="ruby-value">250</span>,<span class="ruby-value">190</span>],[<span class="ruby-value">300</span>,<span class="ruby-value">200</span>],[<span class="ruby-value">350</span>,<span class="ruby-value">180</span>],[<span class="ruby-value">400</span>,<span class="ruby-value">160</span>]]
  <span class="ruby-identifier">l1</span> = [[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>,<span class="ruby-value">35</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">45</span>,<span class="ruby-value">45</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>,<span class="ruby-value">35</span>]]
  <span class="ruby-identifier">u1</span> = [[[<span class="ruby-value">-1</span>,<span class="ruby-value">6</span>],[<span class="ruby-value">0.5</span>,<span class="ruby-value">-3</span>],[<span class="ruby-value">-9</span>,<span class="ruby-value">1</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">-1</span>,<span class="ruby-value">-3</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">-0.1</span>,<span class="ruby-value">-6</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">9</span>],[<span class="ruby-value">1</span>,<span class="ruby-value">-1.5</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">2</span>],[<span class="ruby-value">2</span>,<span class="ruby-value">-5</span>],[<span class="ruby-value">6</span>,<span class="ruby-value">1</span>]]]
  <span class="ruby-identifier">srep1</span> = <span class="ruby-identifier">generate2DDiscreteSrep</span>(<span class="ruby-identifier">points1</span>,<span class="ruby-identifier">l1</span>,<span class="ruby-identifier">u1</span>,<span class="ruby-value">0.01</span>,<span class="ruby-value">1</span>)
  <span class="ruby-identifier">srep1</span>.<span class="ruby-identifier">color</span> = <span class="ruby-constant">Color</span>.<span class="ruby-identifier">green</span>
  <span class="ruby-identifier">srep1</span>.<span class="ruby-identifier">orientation</span> = [<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]
  <span class="ruby-identifier">$sreps</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">srep1</span>

  <span class="ruby-identifier">points2</span> = [[<span class="ruby-value">30</span>,<span class="ruby-value">50</span>],[<span class="ruby-value">10</span>,<span class="ruby-value">100</span>],[<span class="ruby-value">9</span>,<span class="ruby-value">150</span>],[<span class="ruby-value">20</span>,<span class="ruby-value">200</span>],[<span class="ruby-value">50</span>,<span class="ruby-value">240</span>],[<span class="ruby-value">110</span>,<span class="ruby-value">290</span>]]
  <span class="ruby-identifier">l2</span> = [[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>,<span class="ruby-value">35</span>],[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">35</span>,<span class="ruby-value">35</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>],[<span class="ruby-value">40</span>,<span class="ruby-value">40</span>,<span class="ruby-value">40</span>]]
  <span class="ruby-identifier">u2</span> = [[[<span class="ruby-value">6</span>,<span class="ruby-value">1</span>],[<span class="ruby-value">6</span>,<span class="ruby-value">-0.5</span>],[<span class="ruby-value">-9</span>,<span class="ruby-value">1</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">3</span>,<span class="ruby-value">-0.5</span>]],[[<span class="ruby-value">-1</span>,<span class="ruby-value">4</span>],[<span class="ruby-value">5</span>,<span class="ruby-value">-0.5</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">9</span>],[<span class="ruby-value">5</span>,<span class="ruby-value">1</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">9</span>],[<span class="ruby-value">5</span>,<span class="ruby-value">3</span>]],[[<span class="ruby-value">1</span>,<span class="ruby-value">2</span>],[<span class="ruby-value">3</span>,<span class="ruby-value">5</span>],[<span class="ruby-value">6</span>,<span class="ruby-value">1</span>]]]
  <span class="ruby-identifier">srep2</span> = <span class="ruby-identifier">generate2DDiscreteSrep</span>(<span class="ruby-identifier">points2</span>,<span class="ruby-identifier">l2</span>,<span class="ruby-identifier">u2</span>,<span class="ruby-value">0.01</span>,<span class="ruby-value">2</span>)
  <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">color</span> = <span class="ruby-constant">Color</span>.<span class="ruby-identifier">purple</span>
  <span class="ruby-identifier">srep2</span>.<span class="ruby-identifier">orientation</span> = [<span class="ruby-value">1</span>,<span class="ruby-value">0</span>]
  <span class="ruby-identifier">$sreps</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">srep2</span>
  
  <span class="ruby-identifier">refresh</span> <span class="ruby-ivar">@points</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-ivar">@shifts</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- initialConfig-source -->
          
        </div>

        

        
      </div><!-- initialConfig-method -->

    
      <div id="method-i-interpolateKappa" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateKappa</span><span
            class="method-args">(rt, kt, step_size, index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateKappa-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 211</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateKappa</span>(<span class="ruby-identifier">rt</span>, <span class="ruby-identifier">kt</span>, <span class="ruby-identifier">step_size</span>, <span class="ruby-identifier">index</span>)
<span class="ruby-comment"># since rk &lt; 1, we need get r to interpolate kappa</span>
<span class="ruby-comment"># rt is an array that contains radius </span>
<span class="ruby-comment"># this function produces the k array that has the same length as the r array</span>
  <span class="ruby-identifier">rk</span> = [<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">kt</span>].<span class="ruby-identifier">transpose</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-value">:*</span>)}
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#################################################################&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;rk: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rk</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">rkm1</span> = <span class="ruby-identifier">rk</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">x</span>}  
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot; ###############################################################&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;rkm1: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rkm1</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">logrkm1</span> = <span class="ruby-identifier">rkm1</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">x</span>)}
  <span class="ruby-identifier">logrkm1s</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">step_size_s</span> = <span class="ruby-identifier">step_size</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;python python/logrk_interpolate.py &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">logrkm1s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">step_size_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-comment"># the 'interpolated_logrkm1s' file contains interpolated log(1-rk)</span>
  <span class="ruby-identifier">logrkm1_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$logrk_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span> , <span class="ruby-string">&quot;r&quot;</span>)
  <span class="ruby-identifier">ilogrkm1s</span> = <span class="ruby-identifier">logrkm1_file</span>.<span class="ruby-identifier">gets</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;ilogrkm1s: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ilogrkm1s</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ilogrkm1s</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateKappa-source -->
          
        </div>

        

        
      </div><!-- interpolateKappa-method -->

    
      <div id="method-i-interpolateKappa2" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateKappa2</span><span
            class="method-args">(rt,kt,step_size,index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateKappa2-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 232</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateKappa2</span>(<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">kt</span>,<span class="ruby-identifier">step_size</span>,<span class="ruby-identifier">index</span>)
 <span class="ruby-comment"># the boundary should be extrapolated</span>
  <span class="ruby-identifier">rt</span> = <span class="ruby-identifier">rt</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
  <span class="ruby-identifier">rk</span> = [<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">kt</span>].<span class="ruby-identifier">transpose</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-value">:*</span>)}
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#################################################################&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;rk: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rk</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">rkm1</span> = <span class="ruby-identifier">rk</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">x</span>}  
  <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot; ###############################################################&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;rkm1: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rkm1</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">logrkm1</span> = <span class="ruby-identifier">rkm1</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">x</span>)}
  <span class="ruby-identifier">logrkm1_0</span> = <span class="ruby-value">2</span>* <span class="ruby-identifier">logrkm1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">logrkm1</span>[<span class="ruby-value">1</span>]
  <span class="ruby-identifier">logrkm1_last</span> = <span class="ruby-value">2</span> * <span class="ruby-identifier">logrkm1</span>[<span class="ruby-value">-2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">logrkm1</span>[<span class="ruby-value">-1</span>]
  <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">0</span>,<span class="ruby-identifier">logrkm1_0</span>)
  <span class="ruby-identifier">logrkm1</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">logrkm1_last</span>
  <span class="ruby-identifier">logrkm1s</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">step_size_s</span> = <span class="ruby-identifier">step_size</span>.<span class="ruby-identifier">to_s</span>
  
  <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;python python/logrk_interpolate.py &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">logrkm1s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">step_size_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-comment"># the 'interpolated_logrkm1s' file contains interpolated log(1-rk)</span>
  <span class="ruby-identifier">logrkm1_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$logrk_file_path2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span> , <span class="ruby-string">&quot;r&quot;</span>)
  <span class="ruby-identifier">ilogrkm1s</span> = <span class="ruby-identifier">logrkm1_file</span>.<span class="ruby-identifier">gets</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;ilogrkm1s: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ilogrkm1s</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ilogrkm1s</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateKappa2-source -->
          
        </div>

        

        
      </div><!-- interpolateKappa2-method -->

    
      <div id="method-i-interpolateKappa3" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateKappa3</span><span
            class="method-args">(rt,kt,step_size,index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateKappa3-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateKappa3</span>(<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">kt</span>,<span class="ruby-identifier">step_size</span>,<span class="ruby-identifier">index</span>)
<span class="ruby-comment"># linear interpolate and extrapolate kappa</span>
  <span class="ruby-identifier">rt</span> = <span class="ruby-identifier">rt</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>]
  <span class="ruby-identifier">rk</span> = [<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">kt</span>].<span class="ruby-identifier">transpose</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">reduce</span>(<span class="ruby-value">:*</span>)}
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; ------- &gt;o&lt; ------&quot;</span>
  <span class="ruby-identifier">oneMinusRK</span> = <span class="ruby-identifier">rk</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-value">1</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">x</span>}
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot; ------- &gt;o&lt; ------&quot;</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;one minus rk: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">oneMinusRK</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">log1minusRK</span> = <span class="ruby-identifier">oneMinusRK</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">log</span>(<span class="ruby-identifier">x</span>)}
  <span class="ruby-identifier">log1minusRK_0</span> = <span class="ruby-value">2</span> * <span class="ruby-identifier">log1minusRK</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">log1minusRK</span>[<span class="ruby-value">1</span>]
  <span class="ruby-identifier">log1minusRK_last</span> = <span class="ruby-value">2</span> * <span class="ruby-identifier">log1minusRK</span>[<span class="ruby-value">-2</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">log1minusRK</span>[<span class="ruby-value">-1</span>]
  <span class="ruby-identifier">log1minusRK</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-value">0</span>,<span class="ruby-identifier">log1minusRK_0</span>)
  <span class="ruby-identifier">log1minusRK</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">log1minusRK_last</span>
  <span class="ruby-identifier">log1minusRKstr</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">log1minusRK</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">step_size_str</span> = <span class="ruby-identifier">step_size</span>.<span class="ruby-identifier">to_s</span>
  
  <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;python python/logrk_interpolate_linear.py &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">log1minusRKstr</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">step_size_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-comment"># the 'interpolated_logrkm1s' file contains interpolated log(1-rk)</span>
  <span class="ruby-identifier">log1minusRK_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$logrk_file_path3</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span> , <span class="ruby-string">&quot;r&quot;</span>)
  <span class="ruby-identifier">ilog1minusRKs</span> = <span class="ruby-identifier">log1minusRK_file</span>.<span class="ruby-identifier">gets</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;ilogrkm1s: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ilog1minusRKs</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ilog1minusRKs</span>

<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateKappa3-source -->
          
        </div>

        

        
      </div><!-- interpolateKappa3-method -->

    
      <div id="method-i-interpolateRadius" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateRadius</span><span
            class="method-args">(xt,yt,rt,step_size,index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateRadius-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateRadius</span>(<span class="ruby-identifier">xt</span>,<span class="ruby-identifier">yt</span>,<span class="ruby-identifier">rt</span>,<span class="ruby-identifier">step_size</span>,<span class="ruby-identifier">index</span>)
<span class="ruby-comment"># this function interpolates r values</span>
<span class="ruby-comment"># parameters: x values         xt</span>
<span class="ruby-comment">#             y values         yt</span>
<span class="ruby-comment">#             r values         rt </span>
<span class="ruby-comment">#             step size        step_size</span>
  <span class="ruby-identifier">xyt</span> = [<span class="ruby-string">&quot;0&quot;</span>]
  <span class="ruby-identifier">xt</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">!=</span><span class="ruby-value">0</span> 
      <span class="ruby-identifier">xy</span> = <span class="ruby-identifier">xyt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>].<span class="ruby-identifier">to_f</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>( (<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]) <span class="ruby-operator">**</span> <span class="ruby-value">2</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]) <span class="ruby-operator">**</span> <span class="ruby-value">2</span> )
      <span class="ruby-identifier">xyt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">xy</span>.<span class="ruby-identifier">to_s</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">xs</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xyt</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">rs</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rt</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">step_size_s</span> = <span class="ruby-identifier">step_size</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;python python/radius_interpolate.py &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xs</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">rs</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">step_size_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span> )
  <span class="ruby-comment"># the 'interpolated_radius_[index]' file contains interpolated points</span>
  <span class="ruby-identifier">r_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$radius_file_path</span><span class="ruby-operator">+</span><span class="ruby-identifier">index</span>, <span class="ruby-string">&quot;r&quot;</span>)
  <span class="ruby-identifier">irs</span> = <span class="ruby-identifier">r_file</span>.<span class="ruby-identifier">gets</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;irs: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">irs</span>  
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">irs</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateRadius-source -->
          
        </div>

        

        
      </div><!-- interpolateRadius-method -->

    
      <div id="method-i-interpolateSkeletalCurveGamma" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateSkeletalCurveGamma</span><span
            class="method-args">(xt,yt,step_size,index)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateSkeletalCurveGamma-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 166</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateSkeletalCurveGamma</span>(<span class="ruby-identifier">xt</span>,<span class="ruby-identifier">yt</span>,<span class="ruby-identifier">step_size</span>,<span class="ruby-identifier">index</span>)
<span class="ruby-comment"># this function takes the discrete base points and interpolate the gamma (skeletal curves)</span>
<span class="ruby-comment">#   - interpolate gamma can be done using cubic spline </span>
<span class="ruby-comment">#   - this function uses system call on a python routine</span>
  <span class="ruby-comment"># give x, y, stepsize, retrun a interpolated dense points and write it into a file.</span>
  <span class="ruby-comment"># read that file. </span>
  <span class="ruby-comment"># then we have the gamma values. That is for one srep.</span>
  <span class="ruby-comment"># call the python script to generate intepolated gammas</span>
  <span class="ruby-identifier">xs</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xt</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">ys</span> = <span class="ruby-string">'&quot;['</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">yt</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot; &quot;</span>) <span class="ruby-operator">+</span> <span class="ruby-string">']&quot;'</span>
  <span class="ruby-identifier">step_size_s</span> = <span class="ruby-identifier">step_size</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">index</span> = <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">system</span>(<span class="ruby-string">&quot;python python/curve_interpolate.py &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">xs</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ys</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">step_size_s</span> <span class="ruby-operator">+</span> <span class="ruby-string">' '</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-comment"># the 'interpolated_points_[index]' file contains interpolated points</span>

  <span class="ruby-identifier">curve_file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">$points_file_path</span><span class="ruby-operator">+</span><span class="ruby-identifier">index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">&quot;r&quot;</span>)
  <span class="ruby-identifier">ixs</span> = <span class="ruby-identifier">curve_file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>}
  <span class="ruby-identifier">iys</span> = <span class="ruby-identifier">curve_file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>}
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">ixs</span>, <span class="ruby-identifier">iys</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateSkeletalCurveGamma-source -->
          
        </div>

        

        
      </div><!-- interpolateSkeletalCurveGamma-method -->

    
      <div id="method-i-interpolateSpokeAtPos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateSpokeAtPos</span><span
            class="method-args">(u1t, v1t, k1t, d1t, u2t, v2t, k2t, d2t)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateSpokeAtPos-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 404</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateSpokeAtPos</span>(<span class="ruby-identifier">u1t</span>, <span class="ruby-identifier">v1t</span>, <span class="ruby-identifier">k1t</span>, <span class="ruby-identifier">d1t</span>, <span class="ruby-identifier">u2t</span>, <span class="ruby-identifier">v2t</span>, <span class="ruby-identifier">k2t</span>, <span class="ruby-identifier">d2t</span>)
  <span class="ruby-comment"># we know the </span>
  <span class="ruby-comment"># this function interpolates the spole at 1st base points to the right..</span>
  <span class="ruby-comment"># using the formula:</span>
  <span class="ruby-comment">#   u(t+dt) = (1+a(t)*dt)u(t) - k(t)v(t)dt</span>
  <span class="ruby-comment"># </span>
  <span class="ruby-comment"># d1t and d2t are all positive</span>
 <span class="ruby-comment"># puts &quot;uvk: &quot; + u1t.to_s + &quot; &quot; + v1t.to_s + &quot; &quot; + k1t.to_s</span>
  <span class="ruby-identifier">a1</span> = <span class="ruby-identifier">computeAUsingUVK</span>(<span class="ruby-identifier">u1t</span>,<span class="ruby-identifier">v1t</span>,<span class="ruby-identifier">k1t</span>)
  <span class="ruby-identifier">a2</span> = <span class="ruby-identifier">computeAUsingUVK</span>(<span class="ruby-identifier">u2t</span>,<span class="ruby-identifier">v2t</span>,<span class="ruby-identifier">k2t</span>)
  <span class="ruby-identifier">utp1dt0</span> = (<span class="ruby-value">1</span><span class="ruby-operator">+</span><span class="ruby-identifier">a1</span>*<span class="ruby-identifier">d1t</span>) * <span class="ruby-identifier">u1t</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span>  <span class="ruby-identifier">k1t</span> * <span class="ruby-identifier">v1t</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">d1t</span>
  <span class="ruby-identifier">utp1dt1</span> = (<span class="ruby-value">1</span><span class="ruby-operator">+</span><span class="ruby-identifier">a1</span>*<span class="ruby-identifier">d1t</span>) * <span class="ruby-identifier">u1t</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span>  <span class="ruby-identifier">k1t</span> * <span class="ruby-identifier">v1t</span>[<span class="ruby-value">1</span>] * <span class="ruby-identifier">d1t</span>
  <span class="ruby-identifier">utp2dt0</span> = (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">a2</span>*<span class="ruby-identifier">d2t</span>) * <span class="ruby-identifier">u2t</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">+</span>  <span class="ruby-identifier">k2t</span> * <span class="ruby-identifier">v2t</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">d2t</span>
  <span class="ruby-identifier">utp2dt1</span> = (<span class="ruby-value">1</span><span class="ruby-operator">-</span><span class="ruby-identifier">a2</span>*<span class="ruby-identifier">d2t</span>) * <span class="ruby-identifier">u2t</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">+</span>  <span class="ruby-identifier">k2t</span> * <span class="ruby-identifier">v2t</span>[<span class="ruby-value">1</span>] * <span class="ruby-identifier">d2t</span>
 <span class="ruby-comment"># puts &quot;uvkd: &quot; + u2t.to_s + &quot; &quot; + v2t.to_s + &quot; &quot; + k2t.to_s + &quot; &quot; + d2t.to_s</span>
 <span class="ruby-comment"># puts &quot;aaaa: &quot; + utp1dt0.to_s </span>
 <span class="ruby-comment"># puts &quot;bbbb: &quot; + utp2dt0.to_s</span>
 <span class="ruby-comment"># puts &quot;d1t: &quot;+ d1t.to_s</span>
 <span class="ruby-comment"># puts &quot;d2t: &quot;+ d2t.to_s</span>
  <span class="ruby-keyword">return</span> [(<span class="ruby-identifier">utp1dt0</span>*<span class="ruby-identifier">d2t</span><span class="ruby-operator">+</span><span class="ruby-identifier">utp2dt0</span>*<span class="ruby-identifier">d1t</span>)<span class="ruby-operator">/</span>(<span class="ruby-identifier">d1t</span><span class="ruby-operator">+</span><span class="ruby-identifier">d2t</span>), (<span class="ruby-identifier">utp1dt1</span>*<span class="ruby-identifier">d2t</span><span class="ruby-operator">+</span><span class="ruby-identifier">utp2dt1</span>*<span class="ruby-identifier">d1t</span>)<span class="ruby-operator">/</span>(<span class="ruby-identifier">d1t</span><span class="ruby-operator">+</span><span class="ruby-identifier">d2t</span>)]
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateSpokeAtPos-source -->
          
        </div>

        

        
      </div><!-- interpolateSpokeAtPos-method -->

    
      <div id="method-i-interpolateSpokeAtPos2" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">interpolateSpokeAtPos2</span><span
            class="method-args">(ut,vt,kt,dt)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="interpolateSpokeAtPos2-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 426</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">interpolateSpokeAtPos2</span>(<span class="ruby-identifier">ut</span>,<span class="ruby-identifier">vt</span>,<span class="ruby-identifier">kt</span>,<span class="ruby-identifier">dt</span>)
<span class="ruby-comment"># this is the interpolate spoke function for the second button</span>
<span class="ruby-comment">#    u(t+dt) = (1+a(t)*dt)u(t) - k(t)v(t)dt</span>
  <span class="ruby-identifier">at</span> = <span class="ruby-identifier">computeAUsingUVK</span>(<span class="ruby-identifier">ut</span>,<span class="ruby-identifier">vt</span>,<span class="ruby-identifier">kt</span>)
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;norm of v: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">twoDNorm2</span>(<span class="ruby-identifier">vt</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;norm of u: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">twoDNorm2</span>(<span class="ruby-identifier">ut</span>).<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;kt: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">kt</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;at: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">at</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">utdtx</span> = (<span class="ruby-value">1</span><span class="ruby-operator">+</span><span class="ruby-identifier">at</span>*<span class="ruby-identifier">dt</span>) * <span class="ruby-identifier">ut</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">kt</span> * <span class="ruby-identifier">vt</span>[<span class="ruby-value">0</span>] * <span class="ruby-identifier">dt</span>
  <span class="ruby-identifier">utdty</span> = (<span class="ruby-value">1</span><span class="ruby-operator">+</span><span class="ruby-identifier">at</span>*<span class="ruby-identifier">dt</span>) * <span class="ruby-identifier">ut</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">kt</span> * <span class="ruby-identifier">vt</span>[<span class="ruby-value">1</span>] * <span class="ruby-identifier">dt</span>
<span class="ruby-identifier">u</span> = <span class="ruby-identifier">twoDNormalize</span>([<span class="ruby-identifier">utdtx</span>, <span class="ruby-identifier">utdty</span>])
 <span class="ruby-comment"># puts &quot;ut: &quot;+ ut.to_s</span>
 <span class="ruby-comment"># puts &quot;newut: &quot; + [utdtx, utdty].to_s</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">u</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- interpolateSpokeAtPos2-source -->
          
        </div>

        

        
      </div><!-- interpolateSpokeAtPos2-method -->

    
      <div id="method-i-linkLinkingStructurePoints" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">linkLinkingStructurePoints</span><span
            class="method-args">(sreps, app, shift)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="linkLinkingStructurePoints-source">
            <pre><span class="ruby-comment"># File lib/srep_toolbox.rb, line 499</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">linkLinkingStructurePoints</span>(<span class="ruby-identifier">sreps</span>, <span class="ruby-identifier">app</span>, <span class="ruby-identifier">shift</span>)
<span class="ruby-comment"># this function links the intersection points to form a linking structure</span>
  <span class="ruby-identifier">sreps</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">srep</span>, <span class="ruby-identifier">srep_index</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spoke_end</span>, <span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">app</span>.<span class="ruby-identifier">stroke</span>(<span class="ruby-node">&quot;#3399FF&quot;</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;case0: &quot;</span> <span class="ruby-operator">+</span> ( <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> ).<span class="ruby-identifier">to_s</span>
        <span class="ruby-identifier">app</span>.<span class="ruby-identifier">line</span>(<span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>, <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>, <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">3</span>][<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>, <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">3</span>][<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;case3: &quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span>).<span class="ruby-identifier">to_s</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>.<span class="ruby-identifier">length</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>[<span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span>][<span class="ruby-value">2</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">4</span>] <span class="ruby-operator">==</span> <span class="ruby-string">'regular'</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>[<span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span>][<span class="ruby-value">4</span>] <span class="ruby-operator">==</span> <span class="ruby-string">'regular'</span>
          <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;case1: &quot;</span> <span class="ruby-operator">+</span> ( <span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>.<span class="ruby-identifier">length</span> ).<span class="ruby-identifier">to_s</span>
          <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;case2: &quot;</span> <span class="ruby-operator">+</span> ( <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>[<span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span>][<span class="ruby-value">2</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span> ).<span class="ruby-identifier">to_s</span>
          <span class="ruby-identifier">app</span>.<span class="ruby-identifier">line</span>(<span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>, <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>, <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>[<span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span>][<span class="ruby-value">0</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>,  <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>[<span class="ruby-identifier">spoke_end_index</span><span class="ruby-operator">+</span><span class="ruby-value">2</span>][<span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">shift</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- linkLinkingStructurePoints-source -->
          
        </div>

        

        
      </div><!-- linkLinkingStructurePoints-method -->

    
      <div id="method-i-refresh" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">refresh</span><span
            class="method-args">(points, sreps, shifts)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>refresh the UI</p>
          

          
          <div class="method-source-code" id="refresh-source">
            <pre><span class="ruby-comment"># File main.rb, line 733</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">refresh</span> <span class="ruby-identifier">points</span>, <span class="ruby-identifier">sreps</span>, <span class="ruby-identifier">shifts</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">nofill</span>
  <span class="ruby-ivar">@field</span> = <span class="ruby-constant">Field</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">self</span>, <span class="ruby-identifier">points</span>, <span class="ruby-identifier">sreps</span>, <span class="ruby-identifier">shifts</span>
  <span class="ruby-identifier">render_field</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- refresh-source -->
          
        </div>

        

        
      </div><!-- refresh-method -->

    
      <div id="method-i-render_field" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">render_field</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="render_field-source">
            <pre><span class="ruby-comment"># File main.rb, line 254</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">render_field</span>
    <span class="ruby-identifier">clear</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">background</span> <span class="ruby-identifier">rgb</span>(<span class="ruby-value">50</span>, <span class="ruby-value">50</span>, <span class="ruby-value">90</span>, <span class="ruby-value">0.7</span>)
      <span class="ruby-identifier">flow</span> <span class="ruby-value">:margin</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span> <span class="ruby-keyword">do</span>

       <span class="ruby-comment"># code for buttons</span>
      <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Dilate&quot;</span>) { 
            <span class="ruby-identifier">$sreps</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">srep</span><span class="ruby-operator">|</span>
            <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span><span class="ruby-operator">|</span>
              <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">dilate</span>(<span class="ruby-identifier">$dilate_ratio</span>)
            <span class="ruby-keyword">end</span>
            <span class="ruby-comment"># dilate interpolated spokes</span>
            <span class="ruby-comment"># and check intersection </span>
            <span class="ruby-comment"># user can specify first serval count to speed up dilate</span>
            <span class="ruby-keyword">if</span> <span class="ruby-identifier">$dilateCount</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>
              <span class="ruby-identifier">sublinkingPts</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extendInterpolatedSpokes</span>(<span class="ruby-identifier">$dilate_ratio</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-keyword">true</span>)
              <span class="ruby-identifier">sublinkingPts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">p</span><span class="ruby-operator">|</span>
                <span class="ruby-identifier">$linkingPts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">p</span>
              <span class="ruby-keyword">end</span>
            <span class="ruby-keyword">else</span>
              <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extendInterpolatedSpokes</span>(<span class="ruby-identifier">$dilate_ratio</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-keyword">false</span>)
            <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">end</span>
          <span class="ruby-identifier">$linkingPts</span> = <span class="ruby-identifier">$linkingPts</span>.<span class="ruby-identifier">uniq</span>
          <span class="ruby-identifier">$dilateCount</span> = <span class="ruby-identifier">$dilateCount</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
          <span class="ruby-identifier">refresh</span> <span class="ruby-ivar">@points</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-ivar">@shifts</span>
        }

        <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Reset&quot;</span>) {
          <span class="ruby-ivar">@dontGrowLst</span>= []
          <span class="ruby-identifier">initialConfig</span>
        }

        <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Check File&quot;</span>) {
          <span class="ruby-identifier">window</span> <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;draw srep&quot;</span>, <span class="ruby-value">:width</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">402</span>, <span class="ruby-value">:height</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">375</span> <span class="ruby-keyword">do</span>
                  <span class="ruby-identifier">ip</span> = <span class="ruby-constant">InterpolateControl</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>) <span class="ruby-comment"># change dp to ip</span>
          <span class="ruby-keyword">end</span>
        }

       
        <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Load&quot;</span>) {
         <span class="ruby-identifier">window</span> <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;choose file&quot;</span>, <span class="ruby-value">:width</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">250</span>, <span class="ruby-value">:height</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">100</span> <span class="ruby-keyword">do</span>
           <span class="ruby-identifier">flv</span> = <span class="ruby-constant">FileLoaderView</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>) 
         <span class="ruby-keyword">end</span>
        }
        <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Interpolate Spokes&quot;</span>) {
     <span class="ruby-comment"># make this correct!! </span>

     <span class="ruby-comment"># the k is the change of the swings .</span>
    <span class="ruby-comment"># ... which can be approximated by the change of the swings of 3 base points .....</span>
    <span class="ruby-comment"># i guesss...</span>
   <span class="ruby-comment"># need to look at my report!</span>
   <span class="ruby-comment"># </span>
<span class="ruby-comment">#</span>
<span class="ruby-comment">#</span>

         <span class="ruby-identifier">$sreps</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">srep</span>, <span class="ruby-identifier">srep_index</span><span class="ruby-operator">|</span> 
                  <span class="ruby-identifier">file1</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$points_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)
         <span class="ruby-comment">#  puts &quot;file: &quot; +  file1.to_s</span>
          <span class="ruby-identifier">test</span> = <span class="ruby-string">&quot;here!!!!!!!!!!!!!!!1&quot;</span>
                <span class="ruby-identifier">xt</span> = <span class="ruby-identifier">file1</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>}
                   <span class="ruby-identifier">yt</span> = <span class="ruby-identifier">file1</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">y</span><span class="ruby-operator">|</span> <span class="ruby-identifier">y</span>.<span class="ruby-identifier">to_f</span>}
             <span class="ruby-identifier">file2</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$radius_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)
                       <span class="ruby-identifier">rt</span> = <span class="ruby-identifier">file2</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_f</span>}
             <span class="ruby-identifier">file3</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$logrk_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)
             <span class="ruby-identifier">logrkm1</span> = <span class="ruby-identifier">file3</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">logrkm1</span><span class="ruby-operator">|</span> <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">to_f</span>}

           <span class="ruby-identifier">$a_big_number</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
   <span class="ruby-identifier">puts</span> <span class="ruby-identifier">test</span> 
           <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;file: &quot;</span> <span class="ruby-operator">+</span>  <span class="ruby-identifier">file1</span>.<span class="ruby-identifier">to_s</span>

             <span class="ruby-comment"># interpolate one side</span>
             <span class="ruby-identifier">indices</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">base_index</span>
             <span class="ruby-identifier">base_index</span> = <span class="ruby-identifier">$current_base_index</span>
             <span class="ruby-identifier">distance_to_next_base</span> = ( <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>] ) <span class="ruby-operator">-</span> <span class="ruby-identifier">$step_go_so_far</span> 
             <span class="ruby-keyword">if</span> <span class="ruby-identifier">distance_to_next_base</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-comment"># &lt;= reached another base point</span>
               <span class="ruby-identifier">$step_go_so_far</span>  = <span class="ruby-value">0</span>
               <span class="ruby-identifier">$current_base_index</span> = <span class="ruby-identifier">$current_base_index</span> <span class="ruby-operator">+</span><span class="ruby-value">1</span>    
               <span class="ruby-identifier">distance_to_next_base</span> = <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]
               <span class="ruby-identifier">spoke_index</span> = <span class="ruby-identifier">$current_base_index</span>
             <span class="ruby-keyword">end</span>
          
             <span class="ruby-identifier">curr_index</span> = <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">$step_go_so_far</span>  <span class="ruby-operator">+</span> <span class="ruby-value">1</span> 
            <span class="ruby-comment"># this is wrong... .</span>
             <span class="ruby-identifier">d1t</span> = <span class="ruby-value">0.01</span> * <span class="ruby-identifier">$step_go_so_far</span> 
             <span class="ruby-identifier">d2t</span> = <span class="ruby-identifier">distance_to_next_base</span> * <span class="ruby-value">0.01</span> 

             <span class="ruby-comment"># calculate parameters</span>
             <span class="ruby-comment"># read all points, rs, logrkm1s from the file</span>
      <span class="ruby-comment">#       file = File.open($points_file_path + srep_index.to_s, 'r')</span>
            <span class="ruby-comment"># xt/ yt: interpolatd x and y locus</span>
        <span class="ruby-comment">#     xt = file1.gets.split(' ').collect{|x| x.to_f}</span>
              <span class="ruby-comment">#     yt = file1.gets.split(' ').collect{|y| y.to_f}</span>
        <span class="ruby-comment">#     file2 = File.open($radius_file_path + srep_index.to_s, 'r')</span>
          <span class="ruby-comment"># rt: interpolated radius r</span>
        <span class="ruby-comment">#       rt = file2.gets.split(' ').collect{|r| r.to_f}</span>
          <span class="ruby-comment"># logrk: interpolated logrk &lt;= needs to be fixed.</span>
  <span class="ruby-comment">#</span>
<span class="ruby-comment">############################</span>
<span class="ruby-comment">########################</span>
<span class="ruby-comment">##########################</span>
      <span class="ruby-comment">#       file3 = File.open($logrk_file_path + srep_index.to_s, 'r')</span>
       <span class="ruby-comment">#      logrkm1 = file3.gets.split(' ').collect{|logrkm1| logrkm1.to_f}</span>
<span class="ruby-comment">#################</span>
<span class="ruby-comment">###################</span>
<span class="ruby-comment">#################</span>
<span class="ruby-comment"># here it uses the large difference to produce v, which is not good.</span>
             <span class="ruby-keyword">if</span> <span class="ruby-identifier">curr_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">xt</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
               <span class="ruby-identifier">v1t</span> = [<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">curr_index</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]], <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">curr_index</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]]]
            <span class="ruby-comment"># it checks whether it reaches the next base index</span>
               <span class="ruby-keyword">if</span> <span class="ruby-identifier">curr_index</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]
                 <span class="ruby-identifier">v2t</span> = [<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">curr_index</span>], <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]<span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">curr_index</span>]]
               <span class="ruby-keyword">else</span>
                 <span class="ruby-identifier">v2t</span> = [<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]] <span class="ruby-operator">-</span> <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">curr_index</span>], <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]] <span class="ruby-operator">-</span> <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">curr_index</span>]]
               <span class="ruby-keyword">end</span>

    <span class="ruby-comment">#           puts &quot;v1t: &quot; + v1t.to_s</span>
            <span class="ruby-comment"># yes it normalizes the size of v vector</span>
               <span class="ruby-identifier">size_v1t</span> = <span class="ruby-identifier">v1t</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v1t</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>
               <span class="ruby-identifier">norm_v1t</span> = <span class="ruby-identifier">v1t</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">size_v1t</span>} 
               <span class="ruby-identifier">size_v2t</span> = <span class="ruby-identifier">v2t</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v2t</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>
     <span class="ruby-comment">#          puts &quot;size_v2t: &quot; + size_v2t.to_s</span>
               <span class="ruby-identifier">norm_v2t</span> = <span class="ruby-identifier">v2t</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">size_v2t</span>} 
          

<span class="ruby-comment"># these k's are calculated using the stored value of log(1-rk)</span>
               <span class="ruby-identifier">k1t</span> = ( <span class="ruby-value">1</span> <span class="ruby-operator">+</span> ( <span class="ruby-value">-1</span> * <span class="ruby-constant">Math</span>.<span class="ruby-identifier">exp</span>(<span class="ruby-identifier">logrkm1</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]]   ) ) ) <span class="ruby-operator">/</span> <span class="ruby-identifier">rt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]] 
               <span class="ruby-identifier">k2t</span> = ( <span class="ruby-value">1</span> <span class="ruby-operator">+</span> ( <span class="ruby-value">-1</span> * <span class="ruby-constant">Math</span>.<span class="ruby-identifier">exp</span>(<span class="ruby-identifier">logrkm1</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]] ) ) ) <span class="ruby-operator">/</span> <span class="ruby-identifier">rt</span>[<span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>]] 
            
               <span class="ruby-identifier">u1t</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">base_index</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>]
               <span class="ruby-identifier">u2t</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>]
               <span class="ruby-identifier">ui</span> = <span class="ruby-identifier">interpolateSpokeAtPos</span>(<span class="ruby-identifier">u1t</span>, <span class="ruby-identifier">norm_v1t</span>, <span class="ruby-identifier">k1t</span>, <span class="ruby-identifier">d1t</span>, <span class="ruby-identifier">u2t</span>, <span class="ruby-identifier">norm_v2t</span>, <span class="ruby-identifier">k2t</span>, <span class="ruby-identifier">d2t</span>)
      <span class="ruby-comment">#        puts &quot;ui: &quot; + ui.to_s</span>
               <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">interpolated_spokes_begin</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-identifier">yt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-value">-1</span>]    
      <span class="ruby-comment">#        puts &quot;rt: &quot; + rt[curr_index-1].to_s</span>
               <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">interpolated_spokes_end</span>  <span class="ruby-operator">&lt;&lt;</span>  [<span class="ruby-identifier">xt</span>[<span class="ruby-identifier">curr_index</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">ui</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">rt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-identifier">yt</span>[<span class="ruby-identifier">curr_index</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">ui</span>[<span class="ruby-value">1</span>]*<span class="ruby-identifier">rt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-value">-1</span>,[],<span class="ruby-string">'regular'</span>]
               <span class="ruby-comment"># interpolate another side</span>
               <span class="ruby-identifier">u1t</span> = <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">base_index</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]
               <span class="ruby-identifier">u2t</span> = <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]
               <span class="ruby-identifier">ui</span> = <span class="ruby-identifier">interpolateSpokeAtPos</span>(<span class="ruby-identifier">u1t</span>, <span class="ruby-identifier">norm_v1t</span>, <span class="ruby-identifier">k1t</span>, <span class="ruby-identifier">d1t</span>, <span class="ruby-identifier">u2t</span>, <span class="ruby-identifier">norm_v2t</span>, <span class="ruby-identifier">k2t</span>, <span class="ruby-identifier">d2t</span>)
       <span class="ruby-comment">#       puts &quot;ui: &quot; + ui.to_s</span>
               <span class="ruby-identifier">spoke_index</span> = <span class="ruby-identifier">indices</span>[<span class="ruby-identifier">base_index</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">$step_go_so_far</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
               <span class="ruby-identifier">spoke_begin_x</span> = <span class="ruby-identifier">xt</span>[<span class="ruby-identifier">spoke_index</span>]
               <span class="ruby-identifier">spoke_begin_y</span> = <span class="ruby-identifier">yt</span>[<span class="ruby-identifier">spoke_index</span> ]
               <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_begin</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">spoke_begin_x</span>,<span class="ruby-identifier">spoke_begin_y</span>,<span class="ruby-value">-1</span>,[],<span class="ruby-string">'regular'</span>]    
     <span class="ruby-comment">#          puts &quot;rt: &quot; + rt[indices[base_index]+$step_go_so_far].to_s</span>
               <span class="ruby-identifier">spoke_end_x</span> = <span class="ruby-identifier">spoke_begin_x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">ui</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">rt</span>[<span class="ruby-identifier">spoke_index</span>]
               <span class="ruby-identifier">spoke_end_y</span> = <span class="ruby-identifier">spoke_begin_y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">ui</span>[<span class="ruby-value">1</span>]*<span class="ruby-identifier">rt</span>[<span class="ruby-identifier">spoke_index</span>]
               <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_end</span>  <span class="ruby-operator">&lt;&lt;</span>  [<span class="ruby-identifier">spoke_end_x</span>,<span class="ruby-identifier">spoke_end_y</span>,<span class="ruby-value">-1</span>,[],<span class="ruby-string">'regular'</span>]
             <span class="ruby-keyword">else</span>



               <span class="ruby-comment"># add spoke interpolation for end disks</span>
               <span class="ruby-comment"># get atom for end disks</span>
               <span class="ruby-identifier">end_atom_one</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>]
               <span class="ruby-identifier">end_atom_two</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">-1</span>]
               <span class="ruby-identifier">end_atoms</span> = [<span class="ruby-identifier">end_atom_one</span>, <span class="ruby-identifier">end_atom_two</span>]
               <span class="ruby-comment"># get upper and lower and middle spokes</span>
               <span class="ruby-identifier">end_atoms</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">atom</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
                 <span class="ruby-identifier">atom_spoke_dir_plus1</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>]
                 <span class="ruby-identifier">atom_spoke_dir_minus1</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]
                 <span class="ruby-identifier">atom_spoke_dir_zero</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">2</span>]
                 <span class="ruby-identifier">x_diff_1</span> = <span class="ruby-identifier">atom_spoke_dir_zero</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">atom_spoke_dir_plus1</span>[<span class="ruby-value">0</span>]
                 <span class="ruby-identifier">x_diff_2</span> = <span class="ruby-identifier">atom_spoke_dir_zero</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">atom_spoke_dir_minus1</span>[<span class="ruby-value">0</span>]

                 <span class="ruby-identifier">y_diff_1</span> = <span class="ruby-identifier">atom_spoke_dir_zero</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">atom_spoke_dir_plus1</span>[<span class="ruby-value">1</span>]
                 <span class="ruby-identifier">y_diff_2</span> = <span class="ruby-identifier">atom_spoke_dir_zero</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">atom_spoke_dir_minus1</span>[<span class="ruby-value">1</span>]
                 <span class="ruby-identifier">x_step_size_1</span> = <span class="ruby-identifier">x_diff_1</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-value">15</span>
                 <span class="ruby-identifier">y_step_size_1</span> = <span class="ruby-identifier">y_diff_1</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-value">15</span>
                 <span class="ruby-identifier">x_step_size_2</span> = <span class="ruby-identifier">x_diff_2</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-value">15</span>
                 <span class="ruby-identifier">y_step_size_2</span> = <span class="ruby-identifier">y_diff_2</span>.<span class="ruby-identifier">to_f</span> <span class="ruby-operator">/</span> <span class="ruby-value">15</span>
                 <span class="ruby-identifier">previous_x</span> = <span class="ruby-identifier">atom_spoke_dir_plus1</span>[<span class="ruby-value">0</span>] 
                 <span class="ruby-identifier">previous_y</span> = <span class="ruby-identifier">atom_spoke_dir_plus1</span>[<span class="ruby-value">1</span>] 
                 <span class="ruby-identifier">$end_disk_spoke_number</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> 
                   <span class="ruby-identifier">new_spoke_dir_x</span> = <span class="ruby-identifier">previous_x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x_step_size_1</span>
                   <span class="ruby-identifier">new_spoke_dir_y</span> = <span class="ruby-identifier">previous_y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y_step_size_1</span>
                   <span class="ruby-comment"># normalize </span>
                   <span class="ruby-identifier">length_new_spoke</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">new_spoke_dir_x</span><span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">new_spoke_dir_y</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>)
                   <span class="ruby-identifier">new_spoke_dir_x</span> = <span class="ruby-identifier">new_spoke_dir_x</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">length_new_spoke</span>
                   <span class="ruby-identifier">new_spoke_dir_y</span> = <span class="ruby-identifier">new_spoke_dir_y</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">length_new_spoke</span>
                   <span class="ruby-identifier">previous_x</span> = <span class="ruby-identifier">new_spoke_dir_x</span>
                   <span class="ruby-identifier">previous_y</span> = <span class="ruby-identifier">new_spoke_dir_y</span>
                   <span class="ruby-comment"># calculate interpolated spoke end</span>
                   <span class="ruby-identifier">new_spoke_vector_x</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">new_spoke_dir_x</span>
                   <span class="ruby-identifier">new_spoke_vector_y</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">new_spoke_dir_y</span>
                   <span class="ruby-identifier">new_spoke_end</span> = [<span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">new_spoke_vector_x</span>, <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">new_spoke_vector_y</span>,<span class="ruby-value">-1</span>,[],<span class="ruby-string">'end'</span>]
                   <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_begin</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span>, <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span>]
                   <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_end</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_spoke_end</span>
                 <span class="ruby-keyword">end</span>
                 <span class="ruby-identifier">previous_x</span> = <span class="ruby-identifier">atom_spoke_dir_minus1</span>[<span class="ruby-value">0</span>]
                 <span class="ruby-identifier">previous_y</span> = <span class="ruby-identifier">atom_spoke_dir_minus1</span>[<span class="ruby-value">1</span>]
                 <span class="ruby-identifier">$end_disk_spoke_number</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span> 
                   <span class="ruby-identifier">new_spoke_dir_x</span> = <span class="ruby-identifier">previous_x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">x_step_size_2</span>
                   <span class="ruby-identifier">new_spoke_dir_y</span> = <span class="ruby-identifier">previous_y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">y_step_size_2</span>
                   <span class="ruby-comment"># normalize </span>
                   <span class="ruby-identifier">length_new_spoke</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">new_spoke_dir_x</span><span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">new_spoke_dir_y</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>)
                   <span class="ruby-identifier">new_spoke_dir_x</span> = <span class="ruby-identifier">new_spoke_dir_x</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">length_new_spoke</span>
                   <span class="ruby-identifier">new_spoke_dir_y</span> = <span class="ruby-identifier">new_spoke_dir_y</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">length_new_spoke</span>
                   <span class="ruby-identifier">previous_x</span> = <span class="ruby-identifier">new_spoke_dir_x</span>
                   <span class="ruby-identifier">previous_y</span> = <span class="ruby-identifier">new_spoke_dir_y</span>
                   <span class="ruby-comment"># calculate interpolated spoke end</span>
                   <span class="ruby-identifier">new_spoke_vector_x</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">new_spoke_dir_x</span>
                   <span class="ruby-identifier">new_spoke_vector_y</span> = <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">spoke_length</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">new_spoke_dir_y</span>
                   <span class="ruby-identifier">new_spoke_end</span> = [<span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">new_spoke_vector_x</span>, <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">new_spoke_vector_y</span>,<span class="ruby-value">-1</span>,[],<span class="ruby-string">'end'</span>]
                   <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_begin</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">atom</span>.<span class="ruby-identifier">x</span>, <span class="ruby-identifier">atom</span>.<span class="ruby-identifier">y</span>]
                   <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolated_spokes_end</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_spoke_end</span>
                   <span class="ruby-identifier">$sreps</span>[<span class="ruby-identifier">srep_index</span>].<span class="ruby-identifier">interpolate_finished</span> = <span class="ruby-keyword">true</span>
                 <span class="ruby-keyword">end</span>
               <span class="ruby-keyword">end</span>
               <span class="ruby-identifier">$info</span> = <span class="ruby-string">&quot;interpolation finished&quot;</span>
             <span class="ruby-keyword">end</span>
             <span class="ruby-identifier">$step_go_so_far</span> = <span class="ruby-identifier">$step_go_so_far</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
     <span class="ruby-comment">#        puts &quot;count: &quot;+ $step_go_so_far.to_s</span>
             
             <span class="ruby-identifier">refresh</span> <span class="ruby-ivar">@points</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-ivar">@shifts</span>
           <span class="ruby-keyword">end</span>
           <span class="ruby-identifier">$step_go_so_far</span> = <span class="ruby-value">1</span>
           <span class="ruby-identifier">$current_base_index</span> = <span class="ruby-value">0</span>
         <span class="ruby-keyword">end</span>
       }

       <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Info&quot;</span>) {
          <span class="ruby-identifier">window</span> <span class="ruby-value">:title</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;s-rep info&quot;</span>, <span class="ruby-value">:width</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">402</span>, <span class="ruby-value">:height</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">375</span> <span class="ruby-keyword">do</span>
            <span class="ruby-comment"># si = sreps info</span>
                  <span class="ruby-identifier">si</span> = <span class="ruby-constant">SrepInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>)
          <span class="ruby-keyword">end</span>  
       }

<span class="ruby-comment">#              ---------------------------------------------------</span>
<span class="ruby-comment">#                EDIT</span>




      <span class="ruby-identifier">button</span>(<span class="ruby-string">&quot;Interpolate Spokes 2&quot;</span>) {
<span class="ruby-identifier">srep</span> = <span class="ruby-identifier">$sreps</span>[<span class="ruby-value">0</span>]
<span class="ruby-identifier">srep_index</span> = <span class="ruby-value">0</span>
<span class="ruby-identifier">curr_index</span> = <span class="ruby-value">0</span>
   <span class="ruby-comment">#      $sreps.each_with_index do |srep, srep_index| </span>
         <span class="ruby-comment">#   puts &quot;flip:&quot; + $flip.to_s</span>
      
 <span class="ruby-comment">#        if $flip == 0</span>
   <span class="ruby-comment"># do many times .... ( a big number may refer to the number of spokes between each two base points? ) </span>
            <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$points_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)

            <span class="ruby-comment"># xt/ yt: interpolatd x and y locus</span>
            <span class="ruby-identifier">$xt</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_f</span>}
            <span class="ruby-identifier">$yt</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">y</span><span class="ruby-operator">|</span> <span class="ruby-identifier">y</span>.<span class="ruby-identifier">to_f</span>}
             <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$radius_file_path2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)
          <span class="ruby-comment"># rt: interpolated radius r</span>
               <span class="ruby-identifier">$rt</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_f</span>}
          <span class="ruby-comment"># logrk: interpolated logrk &lt;= needs to be fixed.</span>
  <span class="ruby-comment">#</span>
            <span class="ruby-identifier">file</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">$logrk_file_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">srep_index</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-string">'r'</span>)
            <span class="ruby-identifier">$logrkm1</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">gets</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">' '</span>).<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">logrkm1</span><span class="ruby-operator">|</span> <span class="ruby-identifier">logrkm1</span>.<span class="ruby-identifier">to_f</span>}
      <span class="ruby-comment">#      $ui1 = srep.atoms[0].spoke_direction[0]</span>
      <span class="ruby-comment">#      $ui2 = srep.atoms[0].spoke_direction[1]</span>
      <span class="ruby-comment">#         srep.interpolated_spokes_begin &lt;&lt;  [$xt[curr_index],$yt[curr_index]]</span>
       <span class="ruby-comment">#        srep.interpolated_spokes_end  &lt;&lt;  [$xt[curr_index]+$ui1[0]*$rt[curr_index],$yt[curr_index]-$ui1[1]*$rt[curr_index],-1,[],'regular']</span>
       <span class="ruby-comment">#    curr_index = 1</span>
       <span class="ruby-comment">#        srep.interpolated_spokes_begin &lt;&lt;  [$xt[curr_index],$yt[curr_index]]</span>
       <span class="ruby-comment">#        srep.interpolated_spokes_end  &lt;&lt;  [$xt[curr_index]+$ui2[0]*$rt[curr_index],$yt[curr_index]-$ui2[1]*$rt[curr_index],-1,[],'regular']</span>
            <span class="ruby-identifier">$indices</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">base_index</span>
   <span class="ruby-comment">#         $flip = 1 </span>
        <span class="ruby-comment">#     $a_big_number.times do</span>
<span class="ruby-comment">#         else  </span>

          <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;--------------- &gt;_&lt; ---------------&quot;</span>   
     <span class="ruby-comment">#     puts &quot;flip: &quot; + $flip.to_s</span>
            <span class="ruby-comment"># initially it is zero </span>
               <span class="ruby-identifier">base_index</span> = <span class="ruby-identifier">$current_base_index</span>

               <span class="ruby-identifier">distance_to_next_base</span> = ( <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span>] ) <span class="ruby-operator">-</span> <span class="ruby-identifier">$step_go_so_far</span> 
               <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;dis to next base: &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">distance_to_next_base</span>.<span class="ruby-identifier">to_s</span>
             <span class="ruby-comment"># no it is needed.</span>
    <span class="ruby-identifier">curr_index</span> = <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">$step_go_so_far</span>  <span class="ruby-operator">+</span> <span class="ruby-value">1</span> 
                             <span class="ruby-keyword">if</span> <span class="ruby-identifier">distance_to_next_base</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-comment"># &lt;= reached another base point</span>
                       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;############################################################&quot;</span>
                       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;############################################################&quot;</span>
                       <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;at base end!&quot;</span>
                       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;############################################################&quot;</span>
                       <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;############################################################&quot;</span>
                               <span class="ruby-identifier">$step_go_so_far</span>  = <span class="ruby-value">0</span>
                           <span class="ruby-comment"># update current_base_index</span>
                               <span class="ruby-identifier">$current_base_index</span> = <span class="ruby-identifier">$current_base_index</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>    
                               <span class="ruby-identifier">$ui1</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">$current_base_index</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>]
                               <span class="ruby-identifier">$ui2</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-identifier">$current_base_index</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]
                               <span class="ruby-identifier">distance_to_next_base</span> = <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span>]
                           <span class="ruby-comment">#  Why here is no checking for base index out of bound? </span>
                               <span class="ruby-identifier">base_index</span> = <span class="ruby-identifier">$current_base_index</span>
                               <span class="ruby-identifier">spoke_index</span> = <span class="ruby-identifier">$current_base_index</span>
                             <span class="ruby-keyword">end</span>
          
           <span class="ruby-comment"># --&gt;&gt;&gt;&gt;&gt;&gt; after here we have the curr_index</span>
         
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">curr_index</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
         <span class="ruby-identifier">$ui1</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">0</span>]
         <span class="ruby-identifier">$ui2</span> = <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">atoms</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">spoke_direction</span>[<span class="ruby-value">1</span>]
                               <span class="ruby-identifier">distance_to_next_base</span> = <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span>]

                               <span class="ruby-identifier">base_index</span> = <span class="ruby-identifier">$current_base_index</span>
                               <span class="ruby-identifier">spoke_index</span> = <span class="ruby-identifier">$current_base_index</span>
        <span class="ruby-keyword">end</span>
       

           <span class="ruby-comment"># here it uses the large difference to produce v, which is not good.</span>
           <span class="ruby-comment"># the case of interpolating non-end spokes</span>
<span class="ruby-comment">#             if curr_index &lt; $xt.length-1</span>
              <span class="ruby-keyword">if</span> <span class="ruby-identifier">curr_index</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">base_index</span>[<span class="ruby-value">-1</span>]
              <span class="ruby-comment"># calculate v1 </span>
               <span class="ruby-identifier">v1t</span> = [<span class="ruby-identifier">$xt</span>[<span class="ruby-identifier">curr_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">$xt</span>[<span class="ruby-identifier">curr_index</span>], <span class="ruby-identifier">$yt</span>[<span class="ruby-identifier">curr_index</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">$yt</span>[<span class="ruby-identifier">curr_index</span>]]

              <span class="ruby-keyword">end</span>
            <span class="ruby-comment"># normalize the size of v vector</span>
               <span class="ruby-identifier">size_v1t</span> = <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">v1t</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v1t</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>)

      <span class="ruby-identifier">d1t</span> = <span class="ruby-identifier">size_v1t</span>
               <span class="ruby-identifier">norm_v1t</span> = <span class="ruby-identifier">v1t</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">size_v1t</span>} 
     
               <span class="ruby-identifier">k1t</span> = ( <span class="ruby-value">1</span> <span class="ruby-operator">+</span> ( <span class="ruby-value">-1</span> * <span class="ruby-constant">Math</span>.<span class="ruby-identifier">exp</span>(<span class="ruby-identifier">$logrkm1</span>[<span class="ruby-identifier">curr_index</span>]   ) ) ) <span class="ruby-operator">/</span> <span class="ruby-identifier">$rt</span>[<span class="ruby-identifier">curr_index</span>] 
            
            <span class="ruby-comment"># call a method to interpolate </span>
              <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;u1before update&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$ui1</span>.<span class="ruby-identifier">to_s</span>
               <span class="ruby-identifier">$ui1</span> = <span class="ruby-identifier">interpolateSpokeAtPos2</span>(<span class="ruby-identifier">$ui1</span>, <span class="ruby-identifier">norm_v1t</span>, <span class="ruby-value">-1</span>*<span class="ruby-identifier">k1t</span>, <span class="ruby-identifier">d1t</span>)
              <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;u1after update&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$ui1</span>.<span class="ruby-identifier">to_s</span>
              <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;u2before update&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$ui2</span>.<span class="ruby-identifier">to_s</span>
               <span class="ruby-identifier">$ui2</span> = <span class="ruby-identifier">interpolateSpokeAtPos2</span>(<span class="ruby-identifier">$ui2</span>,<span class="ruby-identifier">norm_v1t</span>,<span class="ruby-identifier">k1t</span>,<span class="ruby-identifier">d1t</span>)
              <span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;u2after update&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$ui2</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-comment">#        puts &quot;ui: &quot; + ui.to_s</span>
               <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">interpolated_spokes_begin</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">$xt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-identifier">$yt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-value">-1</span>]    
      <span class="ruby-comment">#        puts &quot;rt: &quot; + rt[curr_index-1].to_s</span>
               <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">interpolated_spokes_end</span>  <span class="ruby-operator">&lt;&lt;</span>  [<span class="ruby-identifier">$xt</span>[<span class="ruby-identifier">curr_index</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">$ui1</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">$rt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-identifier">$yt</span>[<span class="ruby-identifier">curr_index</span>]<span class="ruby-operator">-</span><span class="ruby-identifier">$ui1</span>[<span class="ruby-value">1</span>]*<span class="ruby-identifier">$rt</span>[<span class="ruby-identifier">curr_index</span>],<span class="ruby-value">-1</span>,[],<span class="ruby-string">'regular'</span>]
      <span class="ruby-comment">#         puts $ui1</span>
        <span class="ruby-comment">#       puts $ui2</span>
               <span class="ruby-comment"># interpolate another side</span>
       <span class="ruby-comment">#       puts &quot;ui: &quot; + ui.to_s</span>
               <span class="ruby-identifier">spoke_index</span> = <span class="ruby-identifier">$indices</span>[<span class="ruby-identifier">base_index</span>]<span class="ruby-operator">+</span><span class="ruby-identifier">$step_go_so_far</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
               <span class="ruby-identifier">spoke_begin_x</span> = <span class="ruby-identifier">$xt</span>[<span class="ruby-identifier">spoke_index</span>]
               <span class="ruby-identifier">spoke_begin_y</span> = <span class="ruby-identifier">$yt</span>[<span class="ruby-identifier">spoke_index</span>]
        <span class="ruby-comment">#       $sreps[srep_index].interpolated_spokes_begin &lt;&lt; [spoke_begin_x,spoke_begin_y,-1,[],'regular']    </span>
               <span class="ruby-identifier">spoke_end_x</span> = <span class="ruby-identifier">spoke_begin_x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">$ui2</span>[<span class="ruby-value">0</span>]*<span class="ruby-identifier">$rt</span>[<span class="ruby-identifier">spoke_index</span>]
               <span class="ruby-identifier">spoke_end_y</span> = <span class="ruby-identifier">spoke_begin_y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">$ui2</span>[<span class="ruby-value">1</span>]*<span class="ruby-identifier">$rt</span>[<span class="ruby-identifier">spoke_index</span>]
       <span class="ruby-comment">#        $sreps[srep_index].interpolated_spokes_end  &lt;&lt;  [spoke_end_x,spoke_end_y,-1,[],'regular']</span>
        <span class="ruby-comment">#       puts &quot;ddl&quot; +  $sreps[srep_index].interpolated_spokes_end.to_s</span>
               <span class="ruby-identifier">refresh</span> <span class="ruby-ivar">@points</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-ivar">@shifts</span>
               <span class="ruby-identifier">$step_go_so_far</span> = <span class="ruby-identifier">$step_go_so_far</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>              
       <span class="ruby-comment">#    end</span>
    <span class="ruby-comment">#    end</span>
       }
 <span class="ruby-comment">#            else</span>
<span class="ruby-comment">
               # add spoke interpolation for end disks
               # get atom for end disks
               end_atom_one = srep.atoms[0]
               end_atom_two = srep.atoms[-1]
               end_atoms = [end_atom_one, end_atom_two]
               # get upper and lower and middle spokes
               end_atoms.each_with_index do |atom, i|
                 atom_spoke_dir_plus1 = atom.spoke_direction[0]
                 atom_spoke_dir_minus1 = atom.spoke_direction[1]
                 atom_spoke_dir_zero = atom.spoke_direction[2]
                 x_diff_1 = atom_spoke_dir_zero[0] - atom_spoke_dir_plus1[0]
                 x_diff_2 = atom_spoke_dir_zero[0] - atom_spoke_dir_minus1[0]

                 y_diff_1 = atom_spoke_dir_zero[1] - atom_spoke_dir_plus1[1]
                 y_diff_2 = atom_spoke_dir_zero[1] - atom_spoke_dir_minus1[1]
                 x_step_size_1 = x_diff_1.to_f / 15
                 y_step_size_1 = y_diff_1.to_f / 15
                 x_step_size_2 = x_diff_2.to_f / 15
                 y_step_size_2 = y_diff_2.to_f / 15
                 previous_x = atom_spoke_dir_plus1[0] 
                 previous_y = atom_spoke_dir_plus1[1] 
                 $end_disk_spoke_number.times do 
                   new_spoke_dir_x = previous_x + x_step_size_1
                   new_spoke_dir_y = previous_y + y_step_size_1
                   # normalize 
                   length_new_spoke = Math.sqrt(new_spoke_dir_x**2 + new_spoke_dir_y**2)
                   new_spoke_dir_x = new_spoke_dir_x / length_new_spoke
                   new_spoke_dir_y = new_spoke_dir_y / length_new_spoke
                   previous_x = new_spoke_dir_x
                   previous_y = new_spoke_dir_y
                   # calculate interpolated spoke end
                   new_spoke_vector_x = atom.spoke_length[0]*new_spoke_dir_x
                   new_spoke_vector_y = atom.spoke_length[0]*new_spoke_dir_y
                   new_spoke_end = [atom.x + new_spoke_vector_x, atom.y - new_spoke_vector_y,-1,[],'end']
                   $sreps[srep_index].interpolated_spokes_begin &lt;&lt; [atom.x, atom.y]
                   $sreps[srep_index].interpolated_spokes_end &lt;&lt; new_spoke_end
                 end
                
                 # another end  
                 previous_x = atom_spoke_dir_minus1[0]
                 previous_y = atom_spoke_dir_minus1[1]
                 $end_disk_spoke_number.times do 
                   new_spoke_dir_x = previous_x + x_step_size_2
                   new_spoke_dir_y = previous_y + y_step_size_2
                   # normalize 
                   length_new_spoke = Math.sqrt(new_spoke_dir_x**2 + new_spoke_dir_y**2)
                   new_spoke_dir_x = new_spoke_dir_x / length_new_spoke
                   new_spoke_dir_y = new_spoke_dir_y / length_new_spoke
                   previous_x = new_spoke_dir_x
                   previous_y = new_spoke_dir_y
                   # calculate interpolated spoke end
                   new_spoke_vector_x = atom.spoke_length[0]*new_spoke_dir_x
                   new_spoke_vector_y = atom.spoke_length[0]*new_spoke_dir_y
                   new_spoke_end = [atom.x + new_spoke_vector_x, atom.y - new_spoke_vector_y,-1,[],'end']
                   $sreps[srep_index].interpolated_spokes_begin &lt;&lt; [atom.x, atom.y]
                   $sreps[srep_index].interpolated_spokes_end &lt;&lt; new_spoke_end

#         ---------------------------- all finished 
                   $sreps[srep_index].interpolate_finished = true

      #          @points, $sreps, @shifts
       #          end
            # this is the end of a loop for one pair of spokes    

     #          refresh @points, $sreps, @shifts      
   #            end 
   
     #          $info = &quot;interpolation finished&quot;
  #        end
</span>       

     <span class="ruby-keyword">end</span>
     <span class="ruby-comment"># code for the check list </span>
     <span class="ruby-ivar">@list</span> = [<span class="ruby-string">'Medial Curve'</span>, <span class="ruby-string">'Interpolated Spokes'</span>, <span class="ruby-string">'Extended Spokes'</span>, <span class="ruby-string">'Extended Disks'</span>, <span class="ruby-string">'Linking Structure'</span>]
     <span class="ruby-identifier">stack</span> <span class="ruby-keyword">do</span>
       <span class="ruby-ivar">@list</span>.<span class="ruby-identifier">map!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span><span class="ruby-operator">|</span>
         <span class="ruby-identifier">flow</span> { <span class="ruby-ivar">@c</span> = <span class="ruby-identifier">check</span>; <span class="ruby-identifier">para</span> <span class="ruby-identifier">name</span> }
         [<span class="ruby-ivar">@c</span>, <span class="ruby-identifier">name</span>]
       <span class="ruby-keyword">end</span>
       <span class="ruby-keyword">if</span> <span class="ruby-identifier">$sreps</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">show_curve</span> 
         <span class="ruby-ivar">@list</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked</span> = <span class="ruby-keyword">true</span>
       <span class="ruby-keyword">end</span>
       <span class="ruby-keyword">if</span> <span class="ruby-identifier">$sreps</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">show_interpolated_spokes</span>
         <span class="ruby-ivar">@list</span>[<span class="ruby-value">1</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked</span> = <span class="ruby-keyword">true</span>
       <span class="ruby-keyword">end</span>
       <span class="ruby-keyword">if</span> <span class="ruby-identifier">$sreps</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">show_extend_spokes</span> 
         <span class="ruby-ivar">@list</span>[<span class="ruby-value">2</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked</span> = <span class="ruby-keyword">true</span>
       <span class="ruby-keyword">end</span>
       <span class="ruby-keyword">if</span> <span class="ruby-identifier">$sreps</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">show_extend_disk</span> 
         <span class="ruby-ivar">@list</span>[<span class="ruby-value">3</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked</span> = <span class="ruby-keyword">true</span>
       <span class="ruby-keyword">end</span>
       <span class="ruby-keyword">if</span> <span class="ruby-identifier">$show_linking_structure</span>
         <span class="ruby-ivar">@list</span>[<span class="ruby-value">4</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked</span> = <span class="ruby-keyword">true</span>
       <span class="ruby-keyword">end</span>
       <span class="ruby-identifier">button</span> <span class="ruby-string">&quot;Refresh&quot;</span> <span class="ruby-keyword">do</span>
         <span class="ruby-identifier">$sreps</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">srep</span><span class="ruby-operator">|</span> 
           <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">show_curve</span> = <span class="ruby-ivar">@list</span>[<span class="ruby-value">0</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
           <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">show_interpolated_spokes</span> = <span class="ruby-ivar">@list</span>[<span class="ruby-value">1</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
           <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">show_extend_spokes</span> = <span class="ruby-ivar">@list</span>[<span class="ruby-value">2</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
           <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">show_extend_disk</span> = <span class="ruby-ivar">@list</span>[<span class="ruby-value">3</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
         <span class="ruby-keyword">end</span>
         <span class="ruby-identifier">$show_linking_structure</span> = <span class="ruby-ivar">@list</span>[<span class="ruby-value">4</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
         <span class="ruby-keyword">if</span> <span class="ruby-ivar">@list</span>[<span class="ruby-value">4</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
           <span class="ruby-identifier">$sreps</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">srep</span><span class="ruby-operator">|</span>
             <span class="ruby-identifier">srep</span>.<span class="ruby-identifier">extend_interpolated_spokes_end</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">spoke_end</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">2</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span> 
                   <span class="ruby-identifier">$linkingPts</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">spoke_end</span>[<span class="ruby-value">1</span>]]  
                <span class="ruby-keyword">end</span>
             <span class="ruby-keyword">end</span>
           <span class="ruby-keyword">end</span>
         <span class="ruby-keyword">end</span>
         <span class="ruby-identifier">refresh</span> <span class="ruby-ivar">@points</span>, <span class="ruby-identifier">$sreps</span>, <span class="ruby-ivar">@shifts</span>
         <span class="ruby-keyword">if</span> <span class="ruby-ivar">@list</span>[<span class="ruby-value">4</span>][<span class="ruby-value">0</span>].<span class="ruby-identifier">checked?</span>
       <span class="ruby-comment">#    linkLinkingStructurePoints($sreps, self, 300) </span>
         <span class="ruby-keyword">end</span>         
       <span class="ruby-keyword">end</span>
     <span class="ruby-keyword">end</span>

     <span class="ruby-identifier">stack</span> <span class="ruby-keyword">do</span> <span class="ruby-ivar">@status</span> = <span class="ruby-identifier">para</span> <span class="ruby-value">:stroke</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">black</span> <span class="ruby-keyword">end</span>
     <span class="ruby-ivar">@field</span>.<span class="ruby-identifier">paint</span>
     <span class="ruby-identifier">para</span> <span class="ruby-identifier">$info</span>
   <span class="ruby-keyword">end</span>  
 <span class="ruby-keyword">end</span></pre>
          </div><!-- render_field-source -->
          
        </div>

        

        
      </div><!-- render_field-method -->

    
      <div id="method-i-spline_fit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">spline_fit</span><span
            class="method-args">(sampled_points, interp_points)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>two D norm 2 two D dot product two D vector project</p>
          

          
          <div class="method-source-code" id="spline_fit-source">
            <pre><span class="ruby-comment"># File lib/math_toolbox.rb, line 12</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">spline_fit</span>(<span class="ruby-identifier">sampled_points</span>, <span class="ruby-identifier">interp_points</span>)
        <span class="ruby-comment"># this function takes a given set of discrete points and fit the curve of them using piece wise splines functions      </span>
        
<span class="ruby-keyword">end</span></pre>
          </div><!-- spline_fit-source -->
          
        </div>

        

        
      </div><!-- spline_fit-method -->

    
      <div id="method-i-twoDNorm2" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">twoDNorm2</span><span
            class="method-args">(v)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="twoDNorm2-source">
            <pre><span class="ruby-comment"># File lib/math_toolbox.rb, line 31</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">twoDNorm2</span>(<span class="ruby-identifier">v</span>)
  <span class="ruby-comment"># compute 2D norm</span>
  <span class="ruby-keyword">return</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">sqrt</span>(<span class="ruby-identifier">v</span>[<span class="ruby-value">0</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">v</span>[<span class="ruby-value">1</span>]<span class="ruby-operator">**</span><span class="ruby-value">2</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- twoDNorm2-source -->
          
        </div>

        

        
      </div><!-- twoDNorm2-method -->

    
      <div id="method-i-twoDNormalize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">twoDNormalize</span><span
            class="method-args">(v)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="twoDNormalize-source">
            <pre><span class="ruby-comment"># File lib/math_toolbox.rb, line 36</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">twoDNormalize</span>(<span class="ruby-identifier">v</span>)
  <span class="ruby-identifier">v_norm</span> = <span class="ruby-identifier">twoDNorm2</span>(<span class="ruby-identifier">v</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">v_norm</span>}
<span class="ruby-keyword">end</span></pre>
          </div><!-- twoDNormalize-source -->
          
        </div>

        

        
      </div><!-- twoDNormalize-method -->

    
      <div id="method-i-vector_project" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vector_project</span><span
            class="method-args">(a,b)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="vector_project-source">
            <pre><span class="ruby-comment"># File lib/math_toolbox.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vector_project</span>(<span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span>)
  <span class="ruby-comment"># compute projection a on direction of b</span>
  <span class="ruby-identifier">scalar</span> = <span class="ruby-identifier">dot</span>(<span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">dot</span>(<span class="ruby-identifier">b</span>,<span class="ruby-identifier">b</span>)
  <span class="ruby-identifier">projection</span> = [<span class="ruby-identifier">scalar</span> * <span class="ruby-identifier">b</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">scalar</span> * <span class="ruby-identifier">b</span>[<span class="ruby-value">1</span>]]
  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">projection</span>, <span class="ruby-identifier">scalar</span>] 
<span class="ruby-keyword">end</span></pre>
          </div><!-- vector_project-source -->
          
        </div>

        

        
      </div><!-- vector_project-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.12.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

